<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Wisdom Meter Pro - Advanced self-reflection tool to track and analyze your wisdom development">
    <meta name="keywords" content="wisdom, self-reflection, personal growth, mindfulness, decision making, analytics">
    <meta name="author" content="Wisdom Meter Pro">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Wisdom Meter Pro | Advanced Self-Reflection Tool</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiMwZWE1ZTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMTIgMTdWM2E3IDcgMCAwIDAgMCAxNFoiPjwvcGF0aD48Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCI+PC9jaXJjbGU+PC9zdmc+">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiMwZWE1ZTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMTIgMTdWM2E3IDcgMCAwIDAgMCAxNFoiPjwvcGF0aD48Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCI+PC9jaXJjbGU+PC9zdmc+">
    <!-- Load Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Core Color Palette */
            --primary: #0ea5e9;
            --primary-light: #38bdf8;
            --primary-dark: #0284c7;
            --secondary: #8b5cf6;
            --secondary-light: #a78bfa;
            --secondary-dark: #7c3aed;
            --accent: #f59e0b;
            --accent-light: #fbbf24;
            --accent-dark: #d97706;
            --success: #10b981;
            --success-light: #34d399;
            --warning: #f97316;
            --warning-light: #fb923c;
            --danger: #ef4444;
            --danger-light: #f87171;
            --info: #06b6d4;
            --info-light: #22d3ee;
            
            /* Background Colors */
            --bg-dark: #0f172a;
            --bg-dark-lighter: #1e293b;
            --bg-card: rgba(30, 41, 59, 0.8);
            --bg-card-hover: rgba(30, 41, 59, 0.95);
            --bg-tooltip: rgba(15, 23, 42, 0.95);
            
            /* Text Colors */
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --text-disabled: #64748b;
            
            /* Border Colors */
            --border-light: rgba(148, 163, 184, 0.2);
            --border-medium: rgba(148, 163, 184, 0.3);
            --border-focus: rgba(56, 189, 248, 0.5);
            
            /* Shadow Values */
            --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
            --shadow-glow: 0 0 15px rgba(14, 165, 233, 0.5);
            
            /* Dimensions */
            --border-radius-sm: 0.375rem;
            --border-radius-md: 0.5rem;
            --border-radius-lg: 0.75rem;
            --border-radius-xl: 1rem;
            --border-radius-full: 9999px;
            
            /* Transitions */
            --transition-fast: all 0.2s ease;
            --transition-normal: all 0.3s ease;
            --transition-slow: all 0.5s ease;
            --transition-bounce: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            
            /* Z-index layers */
            --z-tooltip: 10;
            --z-modal: 50;
            --z-overlay: 40;
            --z-dropdown: 30;
            --z-header: 20;
            
            /* Fonts */
            --font-sans: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            --font-mono: 'JetBrains Mono', 'SF Mono', 'Cascadia Code', Menlo, Monaco, Consolas, monospace;
            
            /* Spacing */
            --spacing-1: 0.25rem;
            --spacing-2: 0.5rem;
            --spacing-3: 0.75rem;
            --spacing-4: 1rem;
            --spacing-6: 1.5rem;
            --spacing-8: 2rem;
            --spacing-12: 3rem;
            --spacing-16: 4rem;
            
            /* Safe Area Insets - for notched devices */
            --safe-area-inset-top: env(safe-area-inset-top, 0px);
            --safe-area-inset-right: env(safe-area-inset-right, 0px);
            --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
            --safe-area-inset-left: env(safe-area-inset-left, 0px);
        }

        /* Reset & Base Styles */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
            height: 100%;
            overflow-x: hidden; /* Prevent horizontal overflow */
            -webkit-text-size-adjust: 100%; /* Prevent text size adjustment on orientation change */
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--bg-dark);
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(14, 165, 233, 0.07) 0%, transparent 30%),
                radial-gradient(circle at 80% 70%, rgba(139, 92, 246, 0.07) 0%, transparent 30%),
                radial-gradient(circle at 50% 50%, rgba(15, 23, 42, 0.9) 0%, var(--bg-dark) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            touch-action: manipulation;
            width: 100%; /* Ensure body takes full width */
            max-width: 100vw; /* Prevent horizontal overflow */
            padding: 0; /* Remove default padding */
            margin: 0; /* Remove default margin */
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: var(--spacing-4);
            word-wrap: break-word; /* Prevent text from overflowing */
            max-width: 100%; /* Ensure headings don't overflow */
        }

        h1 {
            font-size: 2.5rem;
        }

        h2 {
            font-size: 1.75rem;
        }

        h3 {
            font-size: 1.5rem;
        }

        p {
            margin-bottom: var(--spacing-4);
            max-width: 100%; /* Ensure text doesn't overflow */
            word-wrap: break-word; /* Break long words if needed */
        }

        a {
            color: var(--primary-light);
            text-decoration: none;
            transition: var(--transition-fast);
        }

        a:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        /* Layout */
        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--spacing-4);
            overflow-x: hidden; /* Prevent horizontal scrolling */
            padding-left: calc(var(--spacing-4) + var(--safe-area-inset-left));
            padding-right: calc(var(--spacing-4) + var(--safe-area-inset-right));
        }

        .grid {
            display: grid;
            gap: var(--spacing-6);
            width: 100%; /* Ensure grid takes full width */
        }

        .flex {
            display: flex;
            flex-wrap: wrap; /* Allow items to wrap on small screens */
        }

        .flex-col {
            flex-direction: column;
        }

        .items-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .justify-center {
            justify-content: center;
        }

        .gap-2 {
            gap: var(--spacing-2);
        }

        .gap-4 {
            gap: var(--spacing-4);
        }

        .gap-6 {
            gap: var(--spacing-6);
        }

        .text-center {
            text-align: center;
        }

        .relative {
            position: relative;
        }

        .absolute {
            position: absolute;
        }

        .sticky {
            position: sticky;
        }

        .top-0 {
            top: 0;
        }

        .right-0 {
            right: 0;
        }

        .w-full {
            width: 100%;
        }

        .h-full {
            height: 100%;
        }

        .mx-auto {
            margin-left: auto;
            margin-right: auto;
        }

        .my-4 {
            margin-top: var(--spacing-4);
            margin-bottom: var(--spacing-4);
        }

        .my-8 {
            margin-top: var(--spacing-8);
            margin-bottom: var(--spacing-8);
        }

        .mt-2 {
            margin-top: var(--spacing-2);
        }

        .mt-4 {
            margin-top: var(--spacing-4);
        }

        .mt-8 {
            margin-top: var(--spacing-8);
        }

        .mb-2 {
            margin-bottom: var(--spacing-2);
        }

        .mb-4 {
            margin-bottom: var(--spacing-4);
        }

        .mb-8 {
            margin-bottom: var(--spacing-8);
        }

        .p-2 {
            padding: var(--spacing-2);
        }

        .p-4 {
            padding: var(--spacing-4);
        }

        .p-6 {
            padding: var(--spacing-6);
        }

        .p-8 {
            padding: var(--spacing-8);
        }

        .py-2 {
            padding-top: var(--spacing-2);
            padding-bottom: var(--spacing-2);
        }

        .py-4 {
            padding-top: var(--spacing-4);
            padding-bottom: var(--spacing-4);
        }

        .px-4 {
            padding-left: var(--spacing-4);
            padding-right: var(--spacing-4);
        }

        .hidden {
            display: none;
        }

        .block {
            display: block;
        }

        .inline-block {
            display: inline-block;
        }

        /* Header & Navigation */
        .app-header {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-light);
            padding: var(--spacing-4) 0;
            position: sticky;
            top: 0;
            z-index: var(--z-header);
            width: 100%; /* Ensure header takes full width */
            padding-top: calc(var(--spacing-4) + var(--safe-area-inset-top));
            padding-left: calc(var(--spacing-4) + var(--safe-area-inset-left));
            padding-right: calc(var(--spacing-4) + var(--safe-area-inset-right));
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--text-primary);
            text-decoration: none;
        }

        .logo:hover {
            text-decoration: none;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: var(--border-radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 900;
        }

        .nav-links {
            display: flex;
            gap: var(--spacing-6);
            align-items: center;
            flex-wrap: wrap; /* Allow nav links to wrap on small screens */
        }

        .nav-link {
            color: var(--text-secondary);
            font-weight: 500;
            transition: var(--transition-fast);
            position: relative;
            padding: var(--spacing-2); /* Add padding for better touch targets */
        }

        .nav-link:hover {
            color: var(--text-primary);
            text-decoration: none;
        }

        .nav-link.active {
            color: var(--primary-light);
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary-light);
            border-radius: var(--border-radius-full);
        }

        /* Mobile Menu */
        .mobile-menu-toggle {
            display: none;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: var(--spacing-2);
            z-index: calc(var(--z-modal) + 1); /* Ensure it's above the mobile menu */
        }

        .mobile-menu {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-dark);
            z-index: var(--z-modal);
            padding: var(--spacing-8);
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-6);
            transform: translateX(100%);
            transition: transform var(--transition-normal);
            overflow-y: auto; /* Allow scrolling if menu is tall */
            padding-top: calc(var(--spacing-8) + var(--safe-area-inset-top));
            padding-bottom: calc(var(--spacing-8) + var(--safe-area-inset-bottom));
            padding-left: calc(var(--spacing-8) + var(--safe-area-inset-left));
            padding-right: calc(var(--spacing-8) + var(--safe-area-inset-right));
        }

        .mobile-menu.active {
            transform: translateX(0);
        }

        .mobile-menu-close {
            position: absolute;
            top: calc(var(--spacing-4) + var(--safe-area-inset-top));
            right: calc(var(--spacing-4) + var(--safe-area-inset-right));
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: var(--spacing-2);
            z-index: 1;
        }

        .mobile-menu .nav-link {
            font-size: 1.25rem;
            padding: var(--spacing-4);
            width: 100%; /* Make links full width for better touch targets */
            text-align: center;
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--border-light);
            padding: var(--spacing-6);
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: var(--transition-normal);
            height: 100%;
            overflow: hidden; /* Prevent content from overflowing */
            word-wrap: break-word; /* Break long words if needed */
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            border-color: var(--border-medium);
            transform: translateY(-2px);
        }

        .card-header {
            margin-bottom: var(--spacing-4);
            padding-bottom: var(--spacing-4);
            border-bottom: 1px solid var(--border-light);
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-2);
            word-wrap: break-word; /* Break long words if needed */
        }

        .card-subtitle {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .card-body {
            flex: 1;
            overflow: hidden; /* Prevent content from overflowing */
        }

        .card-footer {
            margin-top: var(--spacing-4);
            padding-top: var(--spacing-4);
            border-top: 1px solid var(--border-light);
        }

        /* Buttons - IMPROVED SPACING */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-2);
            padding: var(--spacing-2) var(--spacing-4);
            border-radius: var(--border-radius-md);
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            transition: var(--transition-normal);
            border: none;
            outline: none;
            text-align: center;
            white-space: nowrap;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
            max-width: 100%; /* Ensure buttons don't overflow */
            overflow: hidden; /* Hide overflowing text */
            text-overflow: ellipsis; /* Show ellipsis for overflowing text */
            margin: var(--spacing-1); /* Add margin to prevent buttons from touching */
            min-height: 36px; /* Ensure minimum height for touch targets */
            position: relative; /* For proper positioning of any overlays/effects */
        }

        /* Fix for button spacing in groups */
        .btn + .btn {
            margin-left: var(--spacing-2); /* Ensure proper spacing between adjacent buttons */
        }

        .btn:focus {
            outline: none;
            box-shadow: 0 0 0 3px var(--border-focus);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-dark));
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            color: white;
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, var(--secondary-dark), var(--secondary-dark));
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-accent {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: white;
        }

        .btn-accent:hover {
            background: linear-gradient(135deg, var(--accent-dark), var(--accent-dark));
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border-medium);
            color: var(--text-secondary);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            border-color: var(--border-medium);
        }

        .btn-icon {
            width: 36px;
            height: 36px;
            padding: 0;
            border-radius: var(--border-radius-full);
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-lg {
            padding: var(--spacing-3) var(--spacing-6);
            font-size: 1rem;
            min-height: 44px; /* Larger minimum height for larger buttons */
        }

        .btn-block {
            width: 100%;
            display: flex;
            margin-left: 0;
            margin-right: 0;
        }

        /* Button group - prevent double margins */
        .btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-2);
        }

        .btn-group .btn {
            margin: 0; /* Remove margin from buttons in groups */
        }

        /* Home Button */
        .home-button {
            position: fixed;
            bottom: calc(var(--spacing-4) + var(--safe-area-inset-bottom));
            right: calc(var(--spacing-4) + var(--safe-area-inset-right));
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            width: 56px;
            height: 56px;
            border-radius: var(--border-radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            z-index: 10;
            transition: var(--transition-bounce);
            border: none;
            cursor: pointer;
        }

        .home-button:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-glow);
        }

        .home-button svg {
            width: 24px;
            height: 24px;
        }











        /* Form Elements */
        .form-group {
            margin-bottom: var(--spacing-4);
            width: 100%;
        }

        .form-label {
            display: block;
            margin-bottom: var(--spacing-2);
            font-weight: 500;
            color: var(--text-secondary);
        }

        .form-control {
            width: 100%;
            padding: var(--spacing-2) var(--spacing-3);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
            border-radius: var(--border-radius-md);
            color: var(--text-primary);
            transition: var(--transition-fast);
            max-width: 100%;
            min-height: 44px; /* Erhöht für bessere Touch-Ziele */
            font-size: 16px; /* Verhindert iOS-Zoom beim Fokussieren */
            -webkit-appearance: none; /* Entfernt iOS-Standardstyling */
            appearance: none;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--border-focus);
        }

        .form-text {
            display: block;
            margin-top: var(--spacing-1);
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Slider Styling */
        .slider-container {
            position: relative;
            padding: var(--spacing-6) var(--spacing-2) var(--spacing-2);
            width: 100%;
            max-width: 100%;
            margin-bottom: var(--spacing-4);
            touch-action: none; /* Verbessert Touch-Handling */
        }

        .slider-track {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--bg-dark-lighter);
            border-radius: var(--border-radius-full);
            transform: translateY(-50%);
        }

        .slider-progress {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--primary-light));
            border-radius: var(--border-radius-full);
            width: 50%;
        }

        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            background: transparent;
            outline: none;
            position: relative;
            z-index: 2;
            margin: 0; /* Entfernt Standard-Margin */
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 28px; /* Größer für bessere Touch-Ziele */
            height: 28px; /* Größer für bessere Touch-Ziele */
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: var(--border-radius-full);
            cursor: pointer;
            box-shadow: var(--shadow-md);
            transition: var(--transition-normal);
            border: none; /* Entfernt Standard-Rand */
        }

        .slider::-moz-range-thumb {
            width: 28px; /* Größer für bessere Touch-Ziele */
            height: 28px; /* Größer für bessere Touch-Ziele */
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: var(--border-radius-full);
            cursor: pointer;
            border: none;
            box-shadow: var(--shadow-md);
            transition: var(--transition-normal);
        }

        .slider::-webkit-slider-thumb:hover,
        .slider::-moz-range-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 0 0 5px var(--border-focus);
        }

        .slider-values {
            display: flex;
            justify-content: space-between;
            color: var(--text-muted);
            font-size: 0.75rem;
            margin-top: var(--spacing-2);
        }

        .slider-value-indicator {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: var(--spacing-1) var(--spacing-2);
            border-radius: var(--border-radius-md);
            font-size: 0.75rem;
            font-weight: 600;
            opacity: 0;
            transition: var(--transition-fast);
            pointer-events: none;
            z-index: 3;
            white-space: nowrap;
        }

        .slider-value-indicator::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid var(--primary);
        }

        .slider:hover + .slider-value-indicator,
        .slider:focus + .slider-value-indicator {
            opacity: 1;
            top: -30px;
        }

        /* Question Blocks */
        .question-block {
            margin-bottom: var(--spacing-6);
            animation: fadeInUp 0.5s ease forwards;
            opacity: 0;
            transform: translateY(20px);
            position: relative;
            width: 100%;
            max-width: 100%;
            padding-left: 20px;
            box-sizing: border-box;
        }

        .question-block::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
            border-radius: var(--border-radius-full);
            opacity: 0.7;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .question-number {
            display: inline-flex; /* Geändert für bessere Ausrichtung */
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: var(--border-radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            margin-right: var(--spacing-2);
            flex-shrink: 0;
        }

        .question-text {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: var(--spacing-4);
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }

        /* Insights Page Container */
        .insights-container {
            width: 100%;
            max-width: 100%;
            padding: var(--spacing-4);
            overflow-x: hidden;
            box-sizing: border-box;
            padding-left: calc(var(--spacing-4) + var(--safe-area-inset-left));
            padding-right: calc(var(--spacing-4) + var(--safe-area-inset-right));
            padding-bottom: calc(var(--spacing-4) + var(--safe-area-inset-bottom));
        }

        .insights-content {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        .insights-section {
            margin-bottom: var(--spacing-8);
            width: 100%;
            overflow-x: hidden;
        }

        /* Gauge & Charts */
        .gauge-container {
            position: relative;
            width: 100%;
            max-width: 250px;
            margin: 0 auto;
            aspect-ratio: 1;
        }

        .gauge-svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .gauge-bg {
            fill: none;
            stroke: rgba(255, 255, 255, 0.1);
            stroke-width: 12;
        }

        .gauge-progress {
            fill: none;
            stroke: url(#gauge-gradient);
            stroke-width: 12;
            stroke-linecap: round;
            transition: stroke-dasharray 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            filter: drop-shadow(0 0 5px rgba(14, 165, 233, 0.5));
        }

        .gauge-center {
            fill: var(--bg-dark-lighter);
            stroke: rgba(255, 255, 255, 0.1);
            stroke-width: 1;
        }

        .gauge-text-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .gauge-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1;
            background: linear-gradient(135deg, var(--primary-light), var(--secondary-light));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: var(--spacing-1);
        }

        .gauge-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .chart-container {
            width: 100%;
            height: 300px;
            position: relative;
            overflow: hidden;
            margin-bottom: var(--spacing-6);
        }

        .chart-tooltip {
            position: absolute;
            background: var(--bg-tooltip);
            border: 1px solid var(--border-light);
            border-radius: var(--border-radius-md);
            padding: var(--spacing-2) var(--spacing-3);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: var(--z-tooltip);
            box-shadow: var(--shadow-md);
            font-size: 0.875rem;
            max-width: 200px;
            word-wrap: break-word;
        }

        .chart-tooltip-date {
            font-weight: 600;
            margin-bottom: var(--spacing-1);
            color: var(--text-primary);
        }

        .chart-tooltip-value {
            color: var(--primary-light);
            font-weight: 700;
        }

        .chart-tooltip-details {
            margin-top: var(--spacing-2);
            padding-top: var(--spacing-2);
            border-top: 1px solid var(--border-light);
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Tabs */
        .tabs {
            margin-bottom: var(--spacing-4);
            width: 100%;
            overflow-x: hidden;
        }

        .tab-list {
            display: flex;
            gap: var(--spacing-1);
            border-bottom: 1px solid var(--border-light);
            margin-bottom: var(--spacing-4);
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
            -webkit-overflow-scrolling: touch;
            padding-bottom: var(--spacing-2);
            width: 100%;
            -webkit-mask-image: linear-gradient(to right, black 90%, transparent 100%);
            mask-image: linear-gradient(to right, black 90%, transparent 100%);
        }

        .tab-list::-webkit-scrollbar {
            display: none;
        }

        .tab-trigger {
            padding: var(--spacing-2) var(--spacing-4);
            color: var(--text-muted);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-fast);
            border: none;
            background: transparent;
            position: relative;
            white-space: nowrap;
            flex-shrink: 0;
            min-height: 44px; /* Minimum Touch-Zielgröße */
        }

        .tab-trigger:hover {
            color: var(--text-secondary);
        }

        .tab-trigger.active {
            color: var(--primary-light);
        }

        .tab-trigger.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary-light);
            border-radius: var(--border-radius-full);
        }

        .tab-content {
            display: none;
            width: 100%;
            padding: 0 var(--spacing-2);
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Badges */
        .badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-1) var(--spacing-2);
            border-radius: var(--border-radius-full);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
            margin: var(--spacing-1);
            height: 20px;
            min-width: 20px; /* Minimale Breite für bessere Touch-Ziele */
        }

        .badge-primary {
            background: rgba(14, 165, 233, 0.2);
            color: var(--primary-light);
        }

        .badge-secondary {
            background: rgba(139, 92, 246, 0.2);
            color: var(--secondary-light);
        }

        .badge-accent {
            background: rgba(245, 158, 11, 0.2);
            color: var(--accent-light);
        }

        .badge-success {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .badge-warning {
            background: rgba(249, 115, 22, 0.2);
            color: var(--warning);
        }

        .badge-danger {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        /* Tooltips */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip-text {
            visibility: hidden;
            width: 200px;
            background: var(--bg-tooltip);
            color: var(--text-primary);
            text-align: center;
            border-radius: var(--border-radius-md);
            padding: var(--spacing-2) var(--spacing-3);
            position: absolute;
            z-index: var(--z-tooltip);
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: var(--shadow-md);
            font-size: 0.875rem;
            pointer-events: none;
            word-wrap: break-word;
        }

        .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--bg-tooltip) transparent transparent transparent;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: var(--z-modal);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-normal);
            padding: var(--spacing-4);
            padding-top: calc(var(--spacing-4) + var(--safe-area-inset-top));
            padding-bottom: calc(var(--spacing-4) + var(--safe-area-inset-bottom));
            padding-left: calc(var(--spacing-4) + var(--safe-area-inset-left));
            padding-right: calc(var(--spacing-4) + var(--safe-area-inset-right));
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--border-light);
            padding: var(--spacing-6);
            width: 90%;
            max-width: 600px;
            max-height: 85vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: var(--transition-normal);
            box-shadow: var(--shadow-lg);
            position: relative;
            word-wrap: break-word;
            -webkit-overflow-scrolling: touch; /* Verbessert Scrolling auf iOS */
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            margin-bottom: var(--spacing-4);
            padding-bottom: var(--spacing-4);
            border-bottom: 1px solid var(--border-light);
            padding-right: 40px;
        }

        .modal-title {
            color: var(--primary-light);
            font-size: 1.5rem;
            margin-bottom: var(--spacing-2);
            word-wrap: break-word;
        }

        .modal-description {
            color: var(--text-muted);
        }

        .modal-body {
            margin-bottom: var(--spacing-4);
            overflow-x: hidden;
            padding: 0 var(--spacing-2);
        }

        .modal-footer {
            padding-top: var(--spacing-4);
            border-top: 1px solid var(--border-light);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-2);
            flex-wrap: wrap;
        }

        .close-button {
            position: absolute;
            top: var(--spacing-4);
            right: var(--spacing-4);
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition-normal);
            width: 44px; /* Größer für bessere Touch-Ziele */
            height: 44px; /* Größer für bessere Touch-Ziele */
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--border-radius-full);
            z-index: 1;
        }

        .close-button:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(90deg);
        }

        /* Progress Steps */
        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: var(--spacing-6);
            position: relative;
            width: 100%;
            flex-wrap: wrap;
            padding: 0 var(--spacing-2);
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 15px;
            left: var(--spacing-2);
            right: var(--spacing-2);
            height: 2px;
            background: var(--border-light);
            z-index: 0;
        }

        .progress-step {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            min-width: 80px;
            margin-bottom: var(--spacing-4);
        }

        .step-indicator {
            width: 30px;
            height: 30px;
            border-radius: var(--border-radius-full);
            background: var(--bg-dark-lighter);
            border: 2px solid var(--border-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-bottom: var(--spacing-2);
            transition: var(--transition-normal);
        }

        .progress-step.active .step-indicator {
            background: var(--primary);
            border-color: var(--primary-light);
            color: white;
            box-shadow: 0 0 0 4px var(--border-focus);
        }

        .progress-step.completed .step-indicator {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .step-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-align: center;
            transition: var(--transition-normal);
            max-width: 100%;
            word-wrap: break-word;
            padding: 0 var(--spacing-1);
        }

        .progress-step.active .step-label {
            color: var(--primary-light);
            font-weight: 600;
        }

        .progress-step.completed .step-label {
            color: var(--success);
        }

        /* Alerts */
        .alert {
            padding: var(--spacing-3) var(--spacing-4);
            border-radius: var(--border-radius-md);
            margin-bottom: var(--spacing-4);
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-3);
            width: 100%;
            max-width: 100%;
            word-wrap: break-word;
            box-sizing: border-box;
        }

        .alert-icon {
            flex-shrink: 0;
            margin-top: 2px;
        }

        .alert-content {
            flex: 1;
            min-width: 0;
        }

        .alert-title {
            font-weight: 600;
            margin-bottom: var(--spacing-1);
        }

        .alert-message {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .alert-info {
            background: rgba(6, 182, 212, 0.1);
            border-left: 3px solid var(--info);
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border-left: 3px solid var(--success);
        }

        .alert-warning {
            background: rgba(249, 115, 22, 0.1);
            border-left: 3px solid var(--warning);
        }

        .alert-danger {
            background: rgba(239, 68, 68, 0.1);
            border-left: 3px solid var(--danger);
        }

        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .animate-pulse {
            animation: pulse 2s infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }

        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        .skeleton {
            background: linear-gradient(90deg, 
                var(--bg-dark-lighter) 25%, 
                rgba(255, 255, 255, 0.1) 50%, 
                var(--bg-dark-lighter) 75%);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite;
            border-radius: var(--border-radius-md);
        }

        /* Export & Share Features */
        .export-options {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-2);
            margin-top: var(--spacing-4);
            width: 100%;
            padding: 0 var(--spacing-2);
        }

        .export-option {
            flex: 1;
            min-width: 120px;
            padding: var(--spacing-4);
            border-radius: var(--border-radius-md);
            background: var(--bg-card-hover);
            border: 1px solid var(--border-light);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-2);
            cursor: pointer;
            transition: var(--transition-normal);
            word-wrap: break-word;
            min-height: 120px; /* Minimale Höhe für bessere Touch-Ziele */
        }

        .export-option:hover {
            transform: translateY(-2px);
            border-color: var(--primary);
            box-shadow: var(--shadow-md);
        }

        .export-option-icon {
            width: 44px; /* Größer für bessere Touch-Ziele */
            height: 44px; /* Größer für bessere Touch-Ziele */
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(14, 165, 233, 0.1);
            border-radius: var(--border-radius-full);
            color: var(--primary-light);
            margin-bottom: var(--spacing-2);
            flex-shrink: 0;
        }

        .export-option-title {
            font-weight: 600;
            font-size: 0.875rem;
            text-align: center;
        }

        .export-option-description {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-align: center;
        }

        /* Share Dialog */
        .share-dialog {
            padding: var(--spacing-4);
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            max-width: 400px;
            width: 100%;
        }

        .share-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: var(--spacing-4);
        }

        .share-options {
            display: flex;
            gap: var(--spacing-2);
            margin-bottom: var(--spacing-4);
            flex-wrap: wrap;
            justify-content: center;
        }

        .share-option {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-2);
            padding: var(--spacing-2);
            border-radius: var(--border-radius-md);
            cursor: pointer;
            transition: var(--transition-normal);
            min-width: 70px;
            max-width: 90px;
            min-height: 80px; /* Minimale Höhe für bessere Touch-Ziele */
        }

        .share-option:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .share-option-icon {
            width: 44px; /* Größer für bessere Touch-Ziele */
            height: 44px; /* Größer für bessere Touch-Ziele */
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--border-radius-full);
            color: var(--text-primary);
        }

        .share-option-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-align: center;
        }

        .share-link {
            display: flex;
            gap: var(--spacing-2);
            margin-top: var(--spacing-4);
            flex-wrap: wrap;
        }

        .share-link-input {
            flex: 1;
            padding: var(--spacing-2) var(--spacing-3);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
            border-radius: var(--border-radius-md);
            color: var(--text-primary);
            font-size: 0.875rem;
            min-width: 0;
            word-break: break-all;
            min-height: 44px; /* Minimale Höhe für bessere Touch-Ziele */
        }

        /* Notification System */
        .notification-container {
            position: fixed;
            top: calc(20px + var(--safe-area-inset-top));
            right: calc(20px + var(--safe-area-inset-right));
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 350px;
            width: calc(100% - 40px - var(--safe-area-inset-left) - var(--safe-area-inset-right));
            pointer-events: none;
        }

        .notification {
            padding: 15px;
            border-radius: 8px;
            background: var(--bg-card);
            border-left: 4px solid var(--primary);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: flex-start;
            gap: 12px;
            transform: translateX(120%);
            animation: slideIn 0.3s forwards, fadeOut 0.5s 4.5s forwards;
            pointer-events: auto;
            word-wrap: break-word;
            max-width: 100%;
        }

        @keyframes slideIn {
            to { transform: translateX(0); }
        }

        @keyframes fadeOut {
            to { opacity: 0; transform: translateX(120%); }
        }

        .notification-icon {
            flex-shrink: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .notification-content {
            flex: 1;
            min-width: 0;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .notification-message {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .notification-close {
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 8px; /* Größer für bessere Touch-Ziele */
            font-size: 1.25rem;
            line-height: 1;
            flex-shrink: 0;
            width: 32px; /* Feste Breite für bessere Touch-Ziele */
            height: 32px; /* Feste Höhe für bessere Touch-Ziele */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .notification-success {
            border-left-color: var(--success);
        }

        .notification-warning {
            border-left-color: var(--warning);
        }

        .notification-error {
            border-left-color: var(--danger);
        }

        /* Data Visualization Enhancements */
        .chart-legend {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-2);
            margin-top: var(--spacing-4);
            justify-content: center;
            padding: 0 var(--spacing-2);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: var(--spacing-2);
            padding: var(--spacing-1);
            min-height: 32px; /* Minimale Höhe für bessere Touch-Ziele */
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: var(--border-radius-full);
            flex-shrink: 0;
        }

        .chart-filters {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-2);
            margin-bottom: var(--spacing-4);
            padding: 0 var(--spacing-2);
        }

        .chart-filter {
            padding: var(--spacing-1) var(--spacing-2);
            border-radius: var(--border-radius-md);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
            font-size: 0.75rem;
            color: var(--text-muted);
            cursor: pointer;
            transition: var(--transition-fast);
            margin-bottom: var(--spacing-1);
            min-height: 32px; /* Minimale Höhe für bessere Touch-Ziele */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chart-filter.active {
            background: rgba(14, 165, 233, 0.1);
            border-color: var(--primary);
            color: var(--primary-light);
        }

        .chart-filter:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }

        /* Calendar View */
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            margin-top: var(--spacing-4);
            width: 100%;
            padding: 0 var(--spacing-2);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-4);
            flex-wrap: wrap;
            gap: var(--spacing-2);
            padding: 0 var(--spacing-2);
        }

        .calendar-title {
            font-weight: 600;
            font-size: 1.25rem;
        }

        .calendar-nav {
            display: flex;
            gap: var(--spacing-2);
        }

        .calendar-nav-btn {
            width: 44px; /* Größer für bessere Touch-Ziele */
            height: 44px; /* Größer für bessere Touch-Ziele */
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--border-radius-full);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
            color: var(--text-muted);
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .calendar-nav-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }

        .calendar-weekday {
            text-align: center;
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 600;
            padding: var(--spacing-2);
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: var(--border-radius-md);
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--border-light);
            cursor: pointer;
            transition: var(--transition-fast);
            position: relative;
            min-height: 40px; /* Minimale Höhe für bessere Touch-Ziele */
        }

        .calendar-day:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
        }

        .calendar-day-number {
            font-size: 0.875rem;
            font-weight: 500;
        }

        .calendar-day-indicator {
            width: 6px;
            height: 6px;
            border-radius: var(--border-radius-full);
            margin-top: 4px;
        }

        .calendar-day.has-entry .calendar-day-indicator {
            background: var(--primary);
        }

        .calendar-day.today {
            background: rgba(14, 165, 233, 0.1);
            border-color: var(--primary);
        }

        .calendar-day.selected {
            background: rgba(139, 92, 246, 0.1);
            border-color: var(--secondary);
        }

        /* Responsive Adjustments */
        @media (min-width: 768px) {
            .grid-cols-2 {
                grid-template-columns: repeat(2, 1fr);
            }

            .grid-cols-3 {
                grid-template-columns: repeat(3, 1fr);
            }

            .grid-cols-4 {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 767px) {
            .container {
                padding: var(--spacing-2);
                padding-left: calc(var(--spacing-2) + var(--safe-area-inset-left));
                padding-right: calc(var(--spacing-2) + var(--safe-area-inset-right));
            }

            h1 {
                font-size: 2rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            .gauge-value {
                font-size: 2rem;
            }

            .progress-steps {
                flex-direction: column;
                gap: var(--spacing-4);
                align-items: flex-start;
            }

            .progress-steps::before {
                top: 0;
                bottom: 0;
                left: 15px;
                right: auto;
                width: 2px;
                height: auto;
            }

            .progress-step {
                flex-direction: row;
                align-items: flex-start;
                gap: var(--spacing-3);
                width: 100%;
            }

            .step-label {
                text-align: left;
            }

            .nav-links {
                display: none;
            }

            .mobile-menu-toggle {
                display: block;
            }

            .mobile-menu {
                display: flex;
            }

            .modal-content {
                width: 95%;
                padding: var(--spacing-4);
                max-height: 80vh;
            }

            .card {
                padding: var(--spacing-4);
            }

            .question-block {
                padding-left: 15px;
            }

            .calendar {
                grid-template-columns: repeat(7, 1fr);
                gap: 2px;
            }

            .calendar-day-number {
                font-size: 0.75rem;
            }

            .calendar-weekday {
                font-size: 0.7rem;
                padding: var(--spacing-1);
            }

            /* Adjust home button position to prevent overlap with content */
            .home-button {
                bottom: calc(var(--spacing-4) + var(--safe-area-inset-bottom));
                right: calc(var(--spacing-4) + var(--safe-area-inset-right));
                width: 48px;
                height: 48px;
            }

            /* Improve insights page on mobile */
            .insights-container {
                padding: var(--spacing-2);
                padding-left: calc(var(--spacing-2) + var(--safe-area-inset-left));
                padding-right: calc(var(--spacing-2) + var(--safe-area-inset-right));
            }

            /* Ensure buttons have proper spacing on mobile */
            .btn {
                margin: var(--spacing-1);
                padding: var(--spacing-2) var(--spacing-3);
                min-height: 44px; /* Minimale Höhe für bessere Touch-Ziele */
            }

            .btn-group {
                margin: var(--spacing-2) 0;
            }
            
            /* Verbesserte Touch-Ziele für mobile Geräte */
            .tab-trigger, 
            .chart-filter, 
            .calendar-nav-btn,
            .close-button,
            .notification-close {
                min-height: 44px;
                min-width: 44px;
            }
        }

        @media (max-width: 480px) {
            .question-text {
                font-size: 0.9rem;
            }

            .tab-trigger {
                padding: var(--spacing-2);
                font-size: 0.8rem;
            }

            .gauge-value {
                font-size: 1.75rem;
            }

            .logo {
                font-size: 1.25rem;
            }

            .logo-icon {
                width: 28px;
                height: 28px;
            }

            .slider-container {
                padding: var(--spacing-4) var(--spacing-2) var(--spacing-2);
            }

            .slider-values {
                font-size: 0.7rem;
            }

            .home-button {
                width: 48px;
                height: 48px;
                bottom: calc(var(--spacing-2) + var(--safe-area-inset-bottom));
                right: calc(var(--spacing-2) + var(--safe-area-inset-right));
            }

            .home-button svg {
                width: 20px;
                height: 20px;
            }

            /* Calendar adjustments for very small screens */
            .calendar {
                grid-template-columns: repeat(7, 1fr);
                gap: 1px;
            }

            .calendar-day-number {
                font-size: 0.7rem;
            }

            .calendar-day-indicator {
                width: 4px;
                height: 4px;
            }

            /* Ensure notifications don't touch screen edges */
            .notification-container {
                max-width: calc(100% - 20px - var(--safe-area-inset-left) - var(--safe-area-inset-right));
                right: calc(10px + var(--safe-area-inset-right));
                top: calc(10px + var(--safe-area-inset-top));
            }

            /* Make modal content scrollable on very small screens */
            .modal-content {
                max-height: 75vh;
                padding: var(--spacing-3);
            }

            /* Adjust form controls for better touch targets */
            .form-control {
                padding: var(--spacing-3);
                font-size: 16px;
                min-height: 44px;
            }

            /* Ensure buttons have enough space for touch */
            .btn {
                padding: var(--spacing-3) var(--spacing-4);
                min-height: 44px;
            }

            /* Improve insights page on small mobile */
            .insights-container {
                padding: var(--spacing-1);
                padding-left: calc(var(--spacing-1) + var(--safe-area-inset-left));
                padding-right: calc(var(--spacing-1) + var(--safe-area-inset-right));
            }

            .insights-section {
                margin-bottom: var(--spacing-4);
            }

            /* Ensure chart containers don't overflow */
            .chart-container {
                height: 250px;
                margin-bottom: var(--spacing-4);
            }
            
            /* Verbesserte Darstellung auf kleinen Bildschirmen */
            .export-option, .share-option {
                min-width: 100px;
                padding: var(--spacing-2);
            }
            
            .export-option-title, .share-option-label {
                font-size: 0.7rem;
            }
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
                color: black;
            }

            .card {
                box-shadow: none;
                border: 1px solid #ddd;
                background: white;
            }

            .app-header, 
            .btn:not(.btn-print),
            .modal-overlay,
            .slider-container,
            .home-button {
                display: none !important;
            }

            .container {
                width: 100%;
                max-width: 100%;
                padding: 0;
            }

            .chart-container {
                page-break-inside: avoid;
                break-inside: avoid;
            }
        }

        /* Dark Mode Support */
        .dark {
            --bg-dark: #000000;
            --bg-dark-lighter: #111827;
            --bg-card: rgba(17, 24, 39, 0.8);
            --bg-card-hover: rgba(17, 24, 39, 0.95);
            --bg-tooltip: rgba(0, 0, 0, 0.95);
        }

        /* Utility Classes */
        .text-primary { color: var(--primary-light); }
        .text-secondary { color: var(--secondary-light); }
        .text-accent { color: var(--accent-light); }
        .text-success { color: var(--success); }
        .text-warning { color: var(--warning); }
        .text-danger { color: var(--danger); }
        .text-muted { color: var(--text-muted); }

        .bg-primary { background-color: var(--primary); }
        .bg-secondary { background-color: var(--secondary); }
        .bg-accent { background-color: var(--accent); }
        .bg-success { background-color: var(--success); }
        .bg-warning { background-color: var(--warning); }
        .bg-danger { background-color: var(--danger); }
        .bg-dark { background-color: var(--bg-dark); }
        .bg-card { background-color: var(--bg-card); }

        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }
        .font-medium { font-weight: 500; }

        .text-xs { font-size: 0.75rem; }
        .text-sm { font-size: 0.875rem; }
        .text-base { font-size: 1rem; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }
        .text-3xl { font-size: 1.875rem; }
        .text-4xl { font-size: 2.25rem; }

        .rounded-sm { border-radius: var(--border-radius-sm); }
        .rounded-md { border-radius: var(--border-radius-md); }
        .rounded-lg { border-radius: var(--border-radius-lg); }
        .rounded-xl { border-radius: var(--border-radius-xl); }
        .rounded-full { border-radius: var(--border-radius-full); }

        .shadow-sm { box-shadow: var(--shadow-sm); }
        .shadow-md { box-shadow: var(--shadow-md); }
        .shadow-lg { box-shadow: var(--shadow-lg); }
        .shadow-inner { box-shadow: var(--shadow-inner); }
        .shadow-glow { box-shadow: var(--shadow-glow); }

        .border { border: 1px solid var(--border-light); }
        .border-t { border-top: 1px solid var(--border-light); }
        .border-r { border-right: 1px solid var(--border-light); }
        .border-b { border-bottom: 1px solid var(--border-light); }
        .border-l { border-left: 1px solid var(--border-light); }

        .opacity-0 { opacity: 0; }
        .opacity-50 { opacity: 0.5; }
        .opacity-75 { opacity: 0.75; }
        .opacity-100 { opacity: 1; }

        .rotate-45 { transform: rotate(45deg); }
        .rotate-90 { transform: rotate(90deg); }
        .rotate-180 { transform: rotate(180deg); }

        .scale-0 { transform: scale(0); }
        .scale-50 { transform: scale(0.5); }
        .scale-75 { transform: scale(0.75); }
        .scale-90 { transform: scale(0.9); }
        .scale-100 { transform: scale(1); }
        .scale-110 { transform: scale(1.1); }
        .scale-125 { transform: scale(1.25); }
        .scale-150 { transform: scale(1.5); }

        .transition { transition: var(--transition-normal); }
        .transition-fast { transition: var(--transition-fast); }
        .transition-slow { transition: var(--transition-slow); }
        .transition-bounce { transition: var(--transition-bounce); }

        /* Back to Dashboard Button Improvements */
        #back-to-dashboard {
            position: absolute;
            top: calc(140px + var(--safe-area-inset-top));
            right: calc(20px + var(--safe-area-inset-right));
            z-index: 15000;
            padding: var(--spacing-2) var(--spacing-4);
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
            font-weight: 500;
            box-shadow: var(--shadow-md);
            transition: var(--transition-normal);
            border: none;
            cursor: pointer;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            margin: 0;
            min-height: 44px; /* Minimale Höhe für bessere Touch-Ziele */
        }

        #back-to-dashboard:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        #back-to-dashboard svg {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
        }

        @media (max-width: 480px) {
            #back-to-dashboard {
                font-size: 0.8rem;
                padding: var(--spacing-2);
                max-width: 150px;
                top: calc(70px + var(--safe-area-inset-top));
                right: calc(10px + var(--safe-area-inset-right));
            }
            
            #back-to-dashboard svg {
                width: 14px;
                height: 14px;
            }
        }

        /* Media Specific Optimizations */
        /* Ensure images don't overflow their containers */
        img, video, audio, iframe, canvas, svg {
            max-width: 100%;
            height: auto;
            display: block;
        }

        /* Responsive media containers */
        .media-container {
            position: relative;
            width: 100%;
            overflow: hidden;
            border-radius: var(--border-radius-md);
            margin-bottom: var(--spacing-4);
        }

        /* For maintaining aspect ratio on videos and maps */
        .media-container.ratio-16-9 {
            padding-top: 56.25%;
        }

        .media-container.ratio-4-3 {
            padding-top: 75%;
        }

        .media-container.ratio-1-1 {
            padding-top: 100%;
        }

        .media-container iframe,
        .media-container video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Image gallery grid */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: var(--spacing-2);
            margin-bottom: var(--spacing-4);
            padding: 0 var(--spacing-2);
        }

        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: var(--border-radius-md);
            aspect-ratio: 1;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition-normal);
        }

        .gallery-item:hover img {
            transform: scale(1.05);
        }

        /* Audio player styling */
        audio {
            width: 100%;
            margin-bottom: var(--spacing-4);
        }

        /* Custom audio player */
        .audio-player {
            background: var(--bg-card);
            border-radius: var(--border-radius-md);
            padding: var(--spacing-3);
            display: flex;
            align-items: center;
            gap: var(--spacing-3);
            margin-bottom: var(--spacing-4);
            border: 1px solid var(--border-light);
            flex-wrap: wrap;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
            flex: 1;
            min-width: 200px;
        }

        .audio-play-btn {
            width: 44px; /* Größer für bessere Touch-Ziele */
            height: 44px; /* Größer für bessere Touch-Ziele */
            border-radius: var(--border-radius-full);
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
        }

        .audio-progress {
            flex: 1;
            height: 6px;
            background: var(--bg-dark-lighter);
            border-radius: var(--border-radius-full);
            position: relative;
            overflow: hidden;
        }

        .audio-progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: var(--primary);
            border-radius: var(--border-radius-full);
        }

        .audio-time {
            font-size: 0.75rem;
            color: var(--text-muted);
            min-width: 50px;
            text-align: right;
        }

        /* File attachments */
        .file-attachment {
            display: flex;
            align-items: center;
            gap: var(--spacing-3);
            padding: var(--spacing-3);
            background: var(--bg-card);
            border-radius: var(--border-radius-md);
            border: 1px solid var(--border-light);
            margin-bottom: var(--spacing-3);
            transition: var(--transition-fast);
            width: 100%;
            box-sizing: border-box;
            min-height: 60px; /* Minimale Höhe für bessere Touch-Ziele */
        }

        .file-attachment:hover {
            background: var(--bg-card-hover);
            border-color: var(--border-medium);
        }

        .file-icon {
            width: 44px; /* Größer für bessere Touch-Ziele */
            height: 44px; /* Größer für bessere Touch-Ziele */
            background: rgba(14, 165, 233, 0.1);
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-light);
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .file-info {
            flex: 1;
            min-width: 0;
        }

        .file-name {
            font-weight: 500;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .file-meta {
            display: flex;
            gap: var(--spacing-2);
            font-size: 0.75rem;
            color: var(--text-muted);
            flex-wrap: wrap;
        }

        .file-download {
            color: var(--primary-light);
            font-size: 1.25rem;
            cursor: pointer;
            flex-shrink: 0;
            padding: var(--spacing-1);
            width: 44px; /* Größer für bessere Touch-Ziele */
            height: 44px; /* Größer für bessere Touch-Ziele */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Media queries for different screen sizes */
        @media (max-width: 1200px) {
            .image-gallery {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
        }

        @media (max-width: 640px) {
            .image-gallery {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            
            .audio-player {
                flex-wrap: wrap;
                padding: var(--spacing-2);
            }
            
            .audio-controls {
                width: 100%;
                order: 2;
                margin-top: var(--spacing-2);
            }
            
            .audio-time {
                order: 1;
                width: 100%;
                text-align: left;
                margin-bottom: var(--spacing-2);
            }

            /* Improve file attachment on small screens */
            .file-attachment {
                padding: var(--spacing-2);
            }

            .file-name {
                font-size: 0.875rem;
            }

            .file-meta {
                font-size: 0.7rem;
            }

            .file-icon {
                width: 36px;
                height: 36px;
                font-size: 1rem;
            }
        }

        /* Prevent content from being cut off at screen edges */
        .content-wrapper {
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
            padding: 0 var(--spacing-2);
            box-sizing: border-box;
            padding-left: calc(var(--spacing-2) + var(--safe-area-inset-left));
            padding-right: calc(var(--spacing-2) + var(--safe-area-inset-right));
            padding-bottom: calc(var(--spacing-2) + var(--safe-area-inset-bottom));
        }

        /* Fix for iOS Safari viewport issues */
        @supports (-webkit-touch-callout: none) {
            .modal-content, 
            .notification-container,
            .mobile-menu {
                /* Fix for iOS Safari 100vh issue */
                max-height: -webkit-fill-available;
            }

            body, html {
                /* Fix for iOS Safari 100vh issue */
                height: -webkit-fill-available;
            }
            
            /* Verbesserte Touch-Ziele für iOS */
            input, 
            button, 
            select, 
            textarea,
            a {
                cursor: pointer;
                -webkit-tap-highlight-color: transparent;
            }
            
            /* Verhindert ungewolltes Zoomen auf Formularelemente */
            input, 
            select, 
            textarea {
                font-size: 16px;
            }
        }

        /* Insights Page Specific Improvements */
        .insights-page {
            padding: var(--spacing-4);
            padding-left: calc(var(--spacing-4) + var(--safe-area-inset-left));
            padding-right: calc(var(--spacing-4) + var(--safe-area-inset-right));
            padding-bottom: calc(var(--spacing-4) + var(--safe-area-inset-bottom));
            max-width: 100%;
            overflow-x: hidden;
        }

        .insights-card {
            margin-bottom: var(--spacing-4);
            width: 100%;
            box-sizing: border-box;
        }

        .insights-grid {
            display: grid;
            gap: var(--spacing-4);
            width: 100%;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        }

        @media (max-width: 640px) {
            .insights-page {
                padding: var(--spacing-2);
                padding-left: calc(var(--spacing-2) + var(--safe-area-inset-left));
                padding-right: calc(var(--spacing-2) + var(--safe-area-inset-right));
                padding-bottom: calc(var(--spacing-2) + var(--safe-area-inset-bottom));
            }

            .insights-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Mobile-optimierte Stile */
        @media (max-width: 767px) {
            .chart-container {
                height: 200px;
                padding: 2px;
                margin-bottom: 15px;
                overflow: hidden;
            }
            
            #categories-chart-container {
                height: 220px;
            }
            
            #comparison-chart-container {
                height: 230px;
            }
            
            .category-breakdown .mb-3 {
                margin-bottom: 0.5rem;
            }
            
            .category-breakdown .text-xs {
                font-size: 0.65rem;
            }
            
            .strengths-list, .improvements-list {
                font-size: 0.85rem;
            }
            
            .badge {
                font-size: 0.65rem;
                padding: 0.15rem 0.35rem;
            }
            
            #history-table-body td {
                padding: 0.5rem 0.25rem;
                font-size: 0.8rem;
            }
            
            #history-table-body .text-xs {
                font-size: 0.65rem;
            }
            
            #history-table-body .btn-sm {
                padding: 0.25rem;
                width: 32px; /* Größer für bessere Touch-Ziele */
                height: 32px; /* Größer für bessere Touch-Ziele */
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            #history-table-body svg {
                width: 14px;
                height: 14px;
            }
            
            .tab-trigger {
                padding: 0.5rem 0.75rem;
                font-size: 0.8rem;
            }
            
            .period-btn, .compare-btn {
                padding: 0.25rem 0.5rem;
                font-size: 0.75rem;
                min-height: 32px; /* Minimale Höhe für bessere Touch-Ziele */
                min-width: 44px; /* Minimale Breite für bessere Touch-Ziele */
            }
            
            /* Verbesserte Scrolling-Performance */
            .scrollable-container {
                -webkit-overflow-scrolling: touch;
                scroll-behavior: smooth;
            }
            
            /* Verbesserte Berührungsziele */
            .clickable-element {
                min-height: 44px;
                min-width: 44px;
            }
        }
        
        @media (max-width: 375px) {
            .chart-container {
                height: 180px;
            }
            
            #categories-chart-container {
                height: 200px;
            }
            
            #comparison-chart-container {
                height: 210px;
            }
            
            /* Optimierte Schriftgrößen für sehr kleine Bildschirme */
            body {
                font-size: 14px;
            }
            
            h1 {
                font-size: 1.75rem;
            }
            
            h2 {
                font-size: 1.25rem;
            }
            
            h3 {
                font-size: 1.1rem;
            }
            
            .text-xs {
                font-size: 0.65rem;
            }
            
            .text-sm {
                font-size: 0.75rem;
            }
        }
        
        /* Verbesserte Barrierefreiheit */
        :focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }
        
        :focus:not(:focus-visible) {
            outline: none;
        }
        
        :focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }
        
        /* Verbesserte Tastaturnavigation */
        .keyboard-focus {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        /* Verbesserte Ladeanimationen */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto;
        }
        
        .loading-skeleton {
            background: linear-gradient(90deg, 
                var(--bg-dark-lighter) 25%, 
                rgba(255, 255, 255, 0.1) 50%, 
                var(--bg-dark-lighter) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: var(--border-radius-md);
            height: 20px;
            margin-bottom: 8px;
        }
        
        /* Verbesserte Fehlerbehandlung */
        .error-container {
            padding: var(--spacing-4);
            border-radius: var(--border-radius-md);
            background: rgba(239, 68, 68, 0.1);
            border-left: 3px solid var(--danger);
            margin-bottom: var(--spacing-4);
        }
        
        .error-title {
            color: var(--danger);
            font-weight: 600;
            margin-bottom: var(--spacing-2);
        }
        
        .error-message {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }
        
        .error-action {
            margin-top: var(--spacing-3);
            display: flex;
            gap: var(--spacing-2);
            flex-wrap: wrap;
        }
        
        /* Verbesserte Druckoptimierung */
        @media print {
            @page {
                margin: 1cm;
            }
            
            body {
                font-size: 12pt;
                line-height: 1.3;
            }
            
            a {
                text-decoration: underline;
                color: #000;
            }
            
            a[href^="http"]:after {
                content: " (" attr(href) ")";
                font-size: 90%;
            }
            
            img {
                max-width: 100% !important;
                page-break-inside: avoid;
            }
            
            h1, h2, h3, h4 {
                page-break-after: avoid;
                page-break-inside: avoid;
            }
            
            table, figure {
                page-break-inside: avoid;
            }
            
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="app-header">
        <div class="container">
            <div class="flex justify-between items-center">
                <a href="#" class="logo">
                    <div class="logo-icon">W</div>
                    <span>Wisdom Meter Pro</span>
                </a>
                <nav class="nav-links">
                    <a href="#" class="nav-link active">Dashboard</a>
                    <a href="#" class="nav-link" id="history-nav">History</a>
                    <a href="#" class="nav-link" id="insights-nav">Insights</a>
                    <a href="#" class="nav-link" id="settings-nav">Settings</a>
                    <button class="btn btn-icon btn-outline" id="theme-toggle" aria-label="Toggle theme">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
                        </svg>
                    </button>
                    <button class="btn btn-icon btn-outline" id="info-button" aria-label="Show information">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 16v-4"></path>
                            <path d="M12 8h.01"></path>
                        </svg>
                    </button>
                </nav>
                <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Open menu">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobile-menu">
        <button class="mobile-menu-close" id="mobile-menu-close" aria-label="Close menu">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
        <a href="#" class="nav-link active">Dashboard</a>
        <a href="#" class="nav-link" id="mobile-history-nav">History</a>
        <a href="#" class="nav-link" id="mobile-insights-nav">Insights</a>
        <a href="#" class="nav-link" id="mobile-settings-nav">Settings</a>
        <a href="index.html" class="nav-link">Back to Home</a>
    </div>

    <!-- Main Content -->
    <main class="container my-8">
        <!-- Dashboard View -->
        <div id="dashboard-view">
            <div class="flex flex-col md:flex-row justify-between items-center mb-8">
                <div>
                    <h1 class="mb-2">Daily Wisdom Assessment</h1>
                    <p class="text-muted">Reflect on your decisions and measure your wisdom</p>
                </div>
                <div class="flex gap-2 mt-4 md:mt-0">
                    <button class="btn btn-outline" id="export-data">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Export Data
                    </button>
                    <button class="btn btn-outline" id="share-results">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="18" cy="5" r="3"></circle>
                            <circle cx="6" cy="12" r="3"></circle>
                            <circle cx="18" cy="19" r="3"></circle>
                            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                        </svg>
                        Share
                    </button>
                    <button class="btn btn-outline" id="print-results">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="6 9 6 2 18 2 18 9"></polyline>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                            <rect x="6" y="14" width="12" height="8"></rect>
                        </svg>
                        Print
                    </button>
                </div>
            </div>

            <!-- Progress Steps -->
            <div class="progress-steps mb-8">
                <div class="progress-step active" id="step-1">
                    <div class="step-indicator">1</div>
                    <div class="step-label">Self-Reflection</div>
                </div>
                <div class="progress-step" id="step-2">
                    <div class="step-indicator">2</div>
                    <div class="step-label">Results</div>
                </div>
                <div class="progress-step" id="step-3">
                    <div class="step-indicator">3</div>
                    <div class="step-label">Insights</div>
                </div>
            </div>

            <!-- Main Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Assessment Form -->
                <div class="md:col-span-2" id="assessment-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Wisdom Assessment</h2>
                            <p class="card-subtitle">Rate your actions and decisions today</p>
                        </div>
                        <div class="card-body">
                            <form id="wisdom-form">
                                <!-- Question 1 -->
                                <div class="question-block" style="animation-delay: 0ms;">
                                    <label class="question-text">
                                        <span class="question-number">1</span>
                                        How did you navigate the consequences of your choices today?
                                        <span class="tooltip ml-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                            <span class="tooltip-text">Consider how you weighed pros and cons and considered long-term impacts.</span>
                                        </span>
                                    </label>
                                    <div class="slider-container">
                                        <div class="slider-track">
                                            <div class="slider-progress" id="progress-rationality"></div>
                                        </div>
                                        <input type="range" class="slider" id="rationality" name="rationality" min="1" max="5" value="3" 
                                               aria-valuemin="1" aria-valuemax="5" aria-valuenow="3">
                                        <div class="slider-value-indicator" id="value-rationality">3</div>
                                    </div>
                                    <div class="slider-values">
                                        <span>Barely</span>
                                        <span></span>
                                        <span>Moderately</span>
                                        <span></span>
                                        <span>Excellently</span>
                                    </div>
                                </div>

                                <!-- Question 2 -->
                                <div class="question-block" style="animation-delay: 100ms;">
                                    <label class="question-text">
                                        <span class="question-number">2</span>
                                        How did you keep your cool during today's storms?
                                        <span class="tooltip ml-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                            <span class="tooltip-text">Think about moments when you were under pressure or faced unexpected challenges.</span>
                                        </span>
                                    </label>
                                    <div class="slider-container">
                                        <div class="slider-track">
                                            <div class="slider-progress" id="progress-calmness"></div>
                                        </div>
                                        <input type="range" class="slider" id="calmness" name="calmness" min="1" max="5" value="3" 
                                               aria-valuemin="1" aria-valuemax="5" aria-valuenow="3">
                                        <div class="slider-value-indicator" id="value-calmness">3</div>
                                    </div>
                                    <div class="slider-values">
                                        <span>Barely</span>
                                        <span></span>
                                        <span>Moderately</span>
                                        <span></span>
                                        <span>Excellently</span>
                                    </div>
                                </div>

                                <!-- Question 3 -->
                                <div class="question-block" style="animation-delay: 200ms;">
                                    <label class="question-text">
                                        <span class="question-number">3</span>
                                        How much did you try to understand others' viewpoints today?
                                        <span class="tooltip ml-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                            <span class="tooltip-text">Reflect on how well you listened and tried to understand perspectives different from your own.</span>
                                        </span>
                                    </label>
                                    <div class="slider-container">
                                        <div class="slider-track">
                                            <div class="slider-progress" id="progress-empathy"></div>
                                        </div>
                                        <input type="range" class="slider" id="empathy" name="empathy" min="1" max="5" value="3" 
                                               aria-valuemin="1" aria-valuemax="5" aria-valuenow="3">
                                        <div class="slider-value-indicator" id="value-empathy">3</div>
                                    </div>
                                    <div class="slider-values">
                                        <span>Barely</span>
                                        <span></span>
                                        <span>Moderately</span>
                                        <span></span>
                                        <span>Excellently</span>
                                    </div>
                                </div>

                                <!-- Question 4 -->
                                <div class="question-block" style="animation-delay: 300ms;">
                                    <label class="question-text">
                                        <span class="question-number">4</span>
                                        How often did you take time to reflect on your thoughts and actions today?
                                        <span class="tooltip ml-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                            <span class="tooltip-text">Consider moments of self-reflection and how aware you were of your own thoughts and feelings.</span>
                                        </span>
                                    </label>
                                    <div class="slider-container">
                                        <div class="slider-track">
                                            <div class="slider-progress" id="progress-reflection"></div>
                                        </div>
                                        <input type="range" class="slider" id="reflection" name="reflection" min="1" max="5" value="3" 
                                               aria-valuemin="1" aria-valuemax="5" aria-valuenow="3">
                                        <div class="slider-value-indicator" id="value-reflection">3</div>
                                    </div>
                                    <div class="slider-values">
                                        <span>Barely</span>
                                        <span></span>
                                        <span>Moderately</span>
                                        <span></span>
                                        <span>Excellently</span>
                                    </div>
                                </div>

                                <!-- Question 5 -->
                                <div class="question-block" style="animation-delay: 400ms;">
                                    <label class="question-text">
                                        <span class="question-number">5</span>
                                        How much kindness did you show to others today?
                                        <span class="tooltip ml-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                            <span class="tooltip-text">Think about gestures of kindness, helpfulness, and compassion you showed to others.</span>
                                        </span>
                                    </label>
                                    <div class="slider-container">
                                        <div class="slider-track">
                                            <div class="slider-progress" id="progress-kindness"></div>
                                        </div>
                                        <input type="range" class="slider" id="kindness" name="kindness" min="1" max="5" value="3" 
                                               aria-valuemin="1" aria-valuemax="5" aria-valuenow="3">
                                        <div class="slider-value-indicator" id="value-kindness">3</div>
                                    </div>
                                    <div class="slider-values">
                                        <span>Barely</span>
                                        <span></span>
                                        <span>Moderately</span>
                                        <span></span>
                                        <span>Excellently</span>
                                    </div>
                                </div>

                                <!-- Question 6 -->
                                <div class="question-block" style="animation-delay: 500ms;">
                                    <label class="question-text">
                                        <span class="question-number">6</span>
                                        How well did you adapt to unexpected changes or challenges today?
                                        <span class="tooltip ml-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                            <span class="tooltip-text">Consider how flexible and adaptable you were when faced with unexpected situations or changes in plans.</span>
                                        </span>
                                    </label>
                                    <div class="slider-container">
                                        <div class="slider-track">
                                            <div class="slider-progress" id="progress-adaptability"></div>
                                        </div>
                                        <input type="range" class="slider" id="adaptability" name="adaptability" min="1" max="5" value="3" 
                                               aria-valuemin="1" aria-valuemax="5" aria-valuenow="3">
                                        <div class="slider-value-indicator" id="value-adaptability">3</div>
                                    </div>
                                    <div class="slider-values">
                                        <span>Barely</span>
                                        <span></span>
                                        <span>Moderately</span>
                                        <span></span>
                                        <span>Excellently</span>
                                    </div>
                                </div>

                                <!-- Question 7 -->
                                <div class="question-block" style="animation-delay: 600ms;">
                                    <label class="question-text">
                                        <span class="question-number">7</span>
                                        How much did you pursue the right path in difficult choices today?
                                        <span class="tooltip ml-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                            <span class="tooltip-text">Think about ethical dilemmas or difficult decisions and how you applied your values and principles.</span>
                                        </span>
                                    </label>
                                    <div class="slider-container">
                                        <div class="slider-track">
                                            <div class="slider-progress" id="progress-ethics"></div>
                                        </div>
                                        <input type="range" class="slider" id="ethics" name="ethics" min="1" max="5" value="3" 
                                               aria-valuemin="1" aria-valuemax="5" aria-valuenow="3">
                                        <div class="slider-value-indicator" id="value-ethics">3</div>
                                    </div>
                                    <div class="slider-values">
                                        <span>Barely</span>
                                        <span></span>
                                        <span>Moderately</span>
                                        <span></span>
                                        <span>Excellently</span>
                                    </div>
                                </div>

                                <!-- Question 8 -->
                                <div class="question-block" style="animation-delay: 700ms;">
                                    <label class="question-text">
                                        <span class="question-number">8</span>
                                        How eagerly did you seek new knowledge today?
                                        <span class="tooltip ml-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                            <span class="tooltip-text">Reflect on how curious you were and how much you tried to learn new things or deepen your understanding.</span>
                                        </span>
                                    </label>
                                    <div class="slider-container">
                                        <div class="slider-track">
                                            <div class="slider-progress" id="progress-learning"></div>
                                        </div>
                                        <input type="range" class="slider" id="learning" name="learning" min="1" max="5" value="3" 
                                               aria-valuemin="1" aria-valuemax="5" aria-valuenow="3">
                                        <div class="slider-value-indicator" id="value-learning">3</div>
                                    </div>
                                    <div class="slider-values">
                                        <span>Barely</span>
                                        <span></span>
                                        <span>Moderately</span>
                                        <span></span>
                                        <span>Excellently</span>
                                    </div>
                                </div>

                                <!-- Question 9 -->
                                <div class="question-block" style="animation-delay: 800ms;">
                                    <label class="question-text">
                                        <span class="question-number">9</span>
                                        How much did you seek meaning in your actions today?
                                        <span class="tooltip ml-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                            <span class="tooltip-text">Consider whether your actions aligned with your deeper values and goals, and whether you sought meaning in your daily activities.</span>
                                        </span>
                                    </label>
                                    <div class="slider-container">
                                        <div class="slider-track">
                                            <div class="slider-progress" id="progress-meaning"></div>
                                        </div>
                                        <input type="range" class="slider" id="meaning" name="meaning" min="1" max="5" value="3" 
                                               aria-valuemin="1" aria-valuemax="5" aria-valuenow="3">
                                        <div class="slider-value-indicator" id="value-meaning">3</div>
                                    </div>
                                    <div class="slider-values">
                                        <span>Barely</span>
                                        <span></span>
                                        <span>Moderately</span>
                                        <span></span>
                                        <span>Excellently</span>
                                    </div>
                                </div>

                                <!-- Question 10 -->
                                <div class="question-block" style="animation-delay: 900ms;">
                                    <label class="question-text">
                                        <span class="question-number">10</span>
                                        How present were you in the moments you experienced today?
                                        <span class="tooltip ml-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                            <span class="tooltip-text">Reflect on how mindful and present you were, rather than dwelling on the past or worrying about the future.</span>
                                        </span>
                                    </label>
                                    <div class="slider-container">
                                        <div class="slider-track">
                                            <div class="slider-progress" id="progress-presence"></div>
                                        </div>
                                        <input type="range" class="slider" id="presence" name="presence" min="1" max="5" value="3" 
                                               aria-valuemin="1" aria-valuemax="5" aria-valuenow="3">
                                        <div class="slider-value-indicator" id="value-presence">3</div>
                                    </div>
                                    <div class="slider-values">
                                        <span>Barely</span>
                                        <span></span>
                                        <span>Moderately</span>
                                        <span></span>
                                        <span>Excellently</span>
                                    </div>
                                </div>

                                <div class="form-group mt-8">
                                    <label class="form-label">Personal Notes (optional)</label>
                                    <textarea class="form-control" id="personal-notes" rows="3" placeholder="Add personal thoughts or observations here..."></textarea>
                                    <span class="form-text">These notes will be saved with your results.</span>
                                </div>

                                <button type="submit" class="btn btn-primary btn-lg btn-block mt-8">
                                    Calculate Wisdom Score
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="m9 18 6-6-6-6"/>
                                    </svg>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Results Section (initially hidden) -->
                <div class="md:col-span-1" id="results-section" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Your Wisdom Score</h2>
                            <p class="card-subtitle">Result of today's self-reflection</p>
                        </div>
                        <div class="card-body">
                            <div class="gauge-container">
                                <svg class="gauge-svg" viewBox="0 0 100 100">
                                    <!-- Background circle -->
                                    <circle class="gauge-bg" cx="50" cy="50" r="40"></circle>
                                    
                                    <!-- Progress circle -->
                                    <circle class="gauge-progress" id="gauge-progress" 
                                            cx="50" cy="50" r="40"
                                            stroke-dasharray="0 251.2" 
                                            stroke-dashoffset="62.8">
                                    </circle>
                                    
                                    <!-- Center circle -->
                                    <circle class="gauge-center" cx="50" cy="50" r="30"></circle>
                                    
                                    <!-- Gradient definition -->
                                    <defs>
                                        <linearGradient id="gauge-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" stop-color="#0ea5e9" />
                                            <stop offset="50%" stop-color="#8b5cf6" />
                                            <stop offset="100%" stop-color="#f59e0b" />
                                        </linearGradient>
                                    </defs>
                                </svg>
                                <div class="gauge-text-container">
                                    <div class="gauge-value" id="gauge-value">0%</div>
                                    <div class="gauge-label">Wisdom Score</div>
                                </div>
                            </div>
                            
                            <div class="mt-6 text-center">
                                <div class="badge badge-primary mb-2" id="result-category">Assessment</div>
                                <p id="result-message" class="text-center"></p>
                            </div>
                            
                            <div class="mt-6">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm text-muted">Strengths</span>
                                    <span class="badge badge-success" id="strengths-count">0</span>
                                </div>
                                <div id="strengths-list" class="text-sm mb-4"></div>
                                
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm text-muted">Areas for Improvement</span>
                                    <span class="badge badge-warning" id="improvements-count">0</span>
                                </div>
                                <div id="improvements-list" class="text-sm"></div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-outline btn-block" id="view-details-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                                View Details
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Insights Section (initially hidden) -->
                <div class="md:col-span-3" id="insights-section" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Wisdom Insights</h2>
                            <p class="card-subtitle">Deeper analysis of your wisdom development</p>
                        </div>
                        <div class="card-body">
                            <div class="tabs">
                                <div class="tab-list">
                                    <button class="tab-trigger active" data-tab="trends">Trends</button>
                                    <button class="tab-trigger" data-tab="categories">Categories</button>
                                    <button class="tab-trigger" data-tab="comparison">Comparison</button>
                                    <button class="tab-trigger" data-tab="recommendations">Recommendations</button>
                                    <button class="tab-trigger" data-tab="calendar">Calendar</button>
                                </div>
                                
                                <!-- Trends Tab -->
                                <div class="tab-content active" id="tab-trends">
                                    <div class="alert alert-info mb-4">
                                        <div class="alert-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                        </div>
                                        <div class="alert-content">
                                            <div class="alert-title">Wisdom Trends</div>
                                            <div class="alert-message">This chart shows your wisdom development over time. Select a time period to track your progress.</div>
                                        </div>
                                    </div>
                                    
                                    <div class="flex justify-between items-center mb-4">
                                        <div class="flex gap-2">
                                            <button class="btn btn-outline btn-sm period-btn active" data-period="week">Week</button>
                                            <button class="btn btn-outline btn-sm period-btn" data-period="month">Month</button>
                                            <button class="btn btn-outline btn-sm period-btn" data-period="year">Year</button>
                                            <button class="btn btn-outline btn-sm period-btn" data-period="all">All</button>
                                        </div>
                                        <div class="flex gap-2">
                                            <button class="btn btn-icon btn-outline btn-sm" id="refresh-chart" aria-label="Refresh chart">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                    <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
                                                    <path d="M21 3v5h-5"></path>
                                                    <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
                                                    <path d="M8 16H3v5"></path>
                                                </svg>
                                            </button>
                                            <button class="btn btn-icon btn-outline btn-sm" id="download-chart" aria-label="Download chart">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                                    <polyline points="7 10 12 15 17 10"></polyline>
                                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="chart-container">
                                        <canvas id="trends-chart"></canvas>
                                        <div class="chart-tooltip" id="trends-tooltip"></div>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                                        <div class="card p-4">
                                            <div class="text-sm text-muted mb-1">Average</div>
                                            <div class="text-2xl font-bold text-primary" id="average-score">-</div>
                                        </div>
                                        <div class="card p-4">
                                            <div class="text-sm text-muted mb-1">Highest Score</div>
                                            <div class="text-2xl font-bold text-success" id="highest-score">-</div>
                                        </div>
                                        <div class="card p-4">
                                            <div class="text-sm text-muted mb-1">Trend</div>
                                            <div class="text-2xl font-bold" id="trend-indicator">-</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Categories Tab -->
                                <div class="tab-content" id="tab-categories">
                                    <div class="alert alert-info mb-4">
                                        <div class="alert-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                        </div>
                                        <div class="alert-content">
                                            <div class="alert-title">Wisdom Categories</div>
                                            <div class="alert-message">This chart shows your strengths and areas for improvement across different wisdom categories.</div>
                                        </div>
                                    </div>
                                    
                                    <div class="chart-container">
                                        <canvas id="categories-chart"></canvas>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                                        <div>
                                            <h3 class="text-lg font-semibold mb-2">Strongest Categories</h3>
                                            <ul class="space-y-2" id="top-categories">
                                                <!-- Will be filled by JavaScript -->
                                            </ul>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-semibold mb-2">Development Areas</h3>
                                            <ul class="space-y-2" id="bottom-categories">
                                                <!-- Will be filled by JavaScript -->
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Comparison Tab -->
                                <div class="tab-content" id="tab-comparison">
                                    <div class="alert alert-info mb-4">
                                        <div class="alert-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                        </div>
                                        <div class="alert-content">
                                            <div class="alert-title">Comparison Analysis</div>
                                            <div class="alert-message">Compare your wisdom scores with previous periods or average values.</div>
                                        </div>
                                    </div>
                                    
                                    <div class="flex justify-between items-center mb-4">
                                        <div class="flex gap-2">
                                            <button class="btn btn-outline btn-sm compare-btn active" data-compare="previous">Previous</button>
                                            <button class="btn btn-outline btn-sm compare-btn" data-compare="average">Average</button>
                                            <button class="btn btn-outline btn-sm compare-btn" data-compare="best">Best</button>
                                            <button class="btn btn-outline btn-sm compare-btn" data-compare="weekly">Weekly Avg</button>
                                        </div>
                                    </div>
                                    
                                    <div class="chart-container">
                                        <canvas id="comparison-chart"></canvas>
                                    </div>
                                    
                                    <div class="mt-6">
                                        <h3 class="text-lg font-semibold mb-2">Comparison Analysis</h3>
                                        <p id="comparison-analysis" class="text-muted">Select a comparison period to see a detailed analysis.</p>
                                    </div>
                                </div>
                                
                                <!-- Recommendations Tab -->
                                <div class="tab-content" id="tab-recommendations">
                                    <div class="alert alert-info mb-4">
                                        <div class="alert-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                        </div>
                                        <div class="alert-content">
                                            <div class="alert-title">Personal Recommendations</div>
                                            <div class="alert-message">Based on your results, we've compiled some recommendations to enhance your wisdom.</div>
                                        </div>
                                    </div>
                                    
                                    <div id="recommendations-container">
                                        <!-- Will be filled by JavaScript -->
                                    </div>
                                    
                                    <div class="mt-6">
                                        <h3 class="text-lg font-semibold mb-2">Daily Wisdom Practice</h3>
                                        <div class="card p-4 bg-secondary bg-opacity-10">
                                            <p id="daily-wisdom-practice" class="mb-2"></p>
                                            <div class="flex justify-between items-center mt-4">
                                                <button class="btn btn-outline btn-sm" id="new-practice-btn">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                                        <polyline points="17 8 12 3 7 8"></polyline>
                                                        <line x1="12" y1="3" x2="12" y2="15"></line>
                                                    </svg>
                                                    New Practice
                                                </button>
                                                <button class="btn btn-outline btn-sm" id="save-practice-btn">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                                                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                                                        <polyline points="7 3 7 8 15 8"></polyline>
                                                    </svg>
                                                    Save
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Calendar Tab -->
                                <div class="tab-content" id="tab-calendar">
                                    <div class="alert alert-info mb-4">
                                        <div class="alert-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <path d="M12 16v-4"></path>
                                                <path d="M12 8h.01"></path>
                                            </svg>
                                        </div>
                                        <div class="alert-content">
                                            <div class="alert-title">Wisdom Calendar</div>
                                            <div class="alert-message">View your wisdom assessments on a calendar to identify patterns and trends.</div>
                                        </div>
                                    </div>
                                    
                                    <div class="calendar-header">
                                        <div class="calendar-title" id="calendar-title">August 2023</div>
                                        <div class="calendar-nav">
                                            <button class="calendar-nav-btn" id="prev-month">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                    <path d="m15 18-6-6 6-6"/>
                                                </svg>
                                            </button>
                                            <button class="calendar-nav-btn" id="next-month">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                    <path d="m9 18 6-6-6-6"/>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="calendar" id="wisdom-calendar">
                                        <!-- Weekday headers -->
                                        <div class="calendar-weekday">Sun</div>
                                        <div class="calendar-weekday">Mon</div>
                                        <div class="calendar-weekday">Tue</div>
                                        <div class="calendar-weekday">Wed</div>
                                        <div class="calendar-weekday">Thu</div>
                                        <div class="calendar-weekday">Fri</div>
                                        <div class="calendar-weekday">Sat</div>
                                        
                                        <!-- Calendar days will be filled by JavaScript -->
                                    </div>
                                    
                                    <div class="mt-6">
                                        <h3 class="text-lg font-semibold mb-2">Selected Day Details</h3>
                                        <div class="card p-4" id="selected-day-details">
                                            <p class="text-muted">Select a day with an assessment to view details.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- History View (initially hidden) -->
        <div id="history-view" style="display: none;">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h1 class="mb-2">Wisdom History</h1>
                    <p class="text-muted">Overview of your past wisdom assessments</p>
                </div>
                <div class="flex gap-2">
                    <button class="btn btn-outline" id="clear-history">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 6h18"></path>
                            <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                            <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                            <line x1="10" y1="11" x2="10" y2="17"></line>
                            <line x1="14" y1="11" x2="14" y2="17"></line>
                        </svg>
                        Clear History
                    </button>
                    <button class="btn btn-primary btn-responsive-text" id="back-to-dashboard">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m9 18 6-6-6-6"></path>
                        </svg>
                        <span class="full-text">Back to Dashboard</span>
                    </button>
                    
                </div>
            </div>

            <div class="card mb-8">
                <div class="card-header">
                    <h2 class="card-title">Wisdom History</h2>
                    <p class="card-subtitle">Complete overview of your wisdom assessments</p>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="history-chart"></canvas>
                        <div class="chart-tooltip" id="history-tooltip"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="flex justify-between items-center">
                        <h2 class="card-title">Detailed History</h2>
                        <div class="flex gap-2">
                            <div class="form-group mb-0">
                                <input type="text" class="form-control" id="history-search" placeholder="Search...">
                            </div>
                            <button class="btn btn-outline" id="export-history">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                Export CSV
                            </button>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr>
                                    <th class="text-left p-2">Date</th>
                                    <th class="text-left p-2">Wisdom Score</th>
                                    <th class="text-left p-2">Strengths</th>
                                    <th class="text-left p-2">Areas for Improvement</th>
                                    <th class="text-left p-2">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="history-table-body">
                                <!-- Will be filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    <div id="no-history-message" class="text-center p-6 text-muted" style="display: none;">
                        No entries found. Start with your first wisdom assessment!
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings View (initially hidden) -->
        <div id="settings-view" style="display: none;">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h1 class="mb-2">Settings</h1>
                    <p class="text-muted">Customize your Wisdom Meter experience</p>
                </div>
                <div class="flex gap-2">
                    <button class="btn btn-primary" id="back-to-dashboard-from-settings">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m9 18 6-6-6-6"></path>
                        </svg>
                        Back to Dashboard
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Appearance</h2>
                        <p class="card-subtitle">Customize the look and feel</p>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Theme</label>
                            <div class="flex gap-2">
                                <button class="btn btn-outline theme-option active" data-theme="auto">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="4"></circle>
                                        <path d="M12 2v2"></path>
                                        <path d="M12 20v2"></path>
                                        <path d="m4.93 4.93 1.41 1.41"></path>
                                        <path d="m17.66 17.66 1.41 1.41"></path>
                                        <path d="M2 12h2"></path>
                                        <path d="M20 12h2"></path>
                                        <path d="m6.34 17.66-1.41 1.41"></path>
                                        <path d="m19.07 4.93-1.41 1.41"></path>
                                    </svg>
                                    Auto
                                </button>
                                <button class="btn btn-outline theme-option" data-theme="light">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="5"></circle>
                                        <line x1="12" y1="1" x2="12" y2="3"></line>
                                        <line x1="12" y1="21" x2="12" y2="23"></line>
                                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                        <line x1="1" y1="12" x2="3" y2="12"></line>
                                        <line x1="21" y1="12" x2="23" y2="12"></line>
                                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                                    </svg>
                                    Light
                                </button>
                                <button class="btn btn-outline theme-option" data-theme="dark">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
                                    </svg>
                                    Dark
                                </button>
                            </div>
                        </div>

                        <div class="form-group mt-6">
                            <label class="form-label">Color Scheme</label>
                            <div class="flex gap-2 flex-wrap">
                                <button class="btn btn-outline color-option active" data-color="blue">
                                    <span class="inline-block w-4 h-4 rounded-full bg-primary mr-2"></span>
                                    Blue
                                </button>
                                <button class="btn btn-outline color-option" data-color="purple">
                                    <span class="inline-block w-4 h-4 rounded-full bg-secondary mr-2"></span>
                                    Purple
                                </button>
                                <button class="btn btn-outline color-option" data-color="green">
                                    <span class="inline-block w-4 h-4 rounded-full bg-success mr-2"></span>
                                    Green
                                </button>
                                <button class="btn btn-outline color-option" data-color="amber">
                                    <span class="inline-block w-4 h-4 rounded-full bg-accent mr-2"></span>
                                    Amber
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Data Management</h2>
                        <p class="card-subtitle">Manage your wisdom data</p>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Export Options</label>
                            <div class="export-options">
                                <div class="export-option" id="export-json">
                                    <div class="export-option-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                            <polyline points="14 2 14 8 20 8"></polyline>
                                            <path d="M12 18v-6"></path>
                                            <path d="m9 15 3 3 3-3"></path>
                                        </svg>
                                    </div>
                                    <div class="export-option-title">JSON</div>
                                    <div class="export-option-description">Export all data in JSON format</div>
                                </div>
                                <div class="export-option" id="export-csv">
                                    <div class="export-option-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                            <polyline points="14 2 14 8 20 8"></polyline>
                                            <path d="M12 18v-6"></path>
                                            <path d="m9 15 3 3 3-3"></path>
                                        </svg>
                                    </div>
                                    <div class="export-option-title">CSV</div>
                                    <div class="export-option-description">Export all data in CSV format</div>
                                </div>
                                <div class="export-option" id="export-pdf">
                                    <div class="export-option-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                            <polyline points="14 2 14 8 20 8"></polyline>
                                            <path d="M12 18v-6"></path>
                                            <path d="m9 15 3 3 3-3"></path>
                                        </svg>
                                    </div>
                                    <div class="export-option-title">PDF</div>
                                    <div class="export-option-description">Export report as PDF document</div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group mt-6">
                            <label class="form-label">Data Backup</label>
                            <div class="flex gap-2">
                                <button class="btn btn-outline" id="backup-data">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="17 8 12 3 7 8"></polyline>
                                        <line x1="12" y1="3" x2="12" y2="15"></line>
                                    </svg>
                                    Backup Data
                                </button>
                                <button class="btn btn-outline" id="restore-data">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="7 10 12 15 17 10"></polyline>
                                        <line x1="12" y1="15" x2="12" y2="3"></line>
                                    </svg>
                                    Restore Data
                                </button>
                            </div>
                        </div>

                        <div class="form-group mt-6">
                            <label class="form-label">Clear Data</label>
                            <button class="btn btn-outline btn-danger" id="clear-all-data">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M3 6h18"></path>
                                    <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                                    <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                                </svg>
                                Clear All Data
                            </button>
                            <span class="form-text">This action cannot be undone. All your wisdom data will be permanently deleted.</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Notifications</h2>
                        <p class="card-subtitle">Manage reminders and notifications</p>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Daily Reminder</label>
                            <div class="flex items-center gap-4">
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" id="enable-reminder" class="form-control w-auto">
                                    <span>Enable daily reminder</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group mt-4" id="reminder-time-container">
                            <label class="form-label">Reminder Time</label>
                            <input type="time" id="reminder-time" class="form-control" value="20:00">
                            <span class="form-text">Set the time for your daily wisdom assessment reminder.</span>
                        </div>

                        <div class="form-group mt-6">
                            <label class="form-label">Browser Notifications</label>
                            <button class="btn btn-outline" id="enable-notifications">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                                </svg>
                                Enable Notifications
                            </button>
                            <span class="form-text">Allow browser notifications to receive reminders even when the app is closed.</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">About</h2>
                        <p class="card-subtitle">Information about Wisdom Meter Pro</p>
                    </div>
                    <div class="card-body">
                        <div class="text-center mb-6">
                            <div class="logo-icon mx-auto mb-4" style="width: 64px; height: 64px; font-size: 24px;">W</div>
                            <h3 class="text-xl font-bold">Wisdom Meter Pro</h3>
                            <p class="text-sm text-muted">Version 2.0.1</p>
                        </div>

                        <p class="mb-4">Wisdom Meter Pro is an advanced self-reflection tool designed to help you track and improve your wisdom through daily assessments.</p>

                        <div class="flex justify-center gap-4 mt-6">
                            <a href="https://example.com/privacy" target="_blank" class="text-primary text-sm">Privacy Policy</a>
                            <a href="https://example.com/terms" target="_blank" class="text-primary text-sm">Terms of Service</a>
                            <a href="https://example.com/contact" target="_blank" class="text-primary text-sm">Contact Us</a>
                        </div>

                        <div class="mt-6 text-center">
                            <a href="index.html" class="btn btn-outline">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                                </svg>
                                Return to Homepage
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Home Button -->
    <a href="index.html" class="home-button" aria-label="Return to homepage">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
        </svg>
    </a>

    <!-- Info Modal -->
    <div class="modal-overlay" id="info-modal">
        <div class="modal-content">
            <button class="close-button" id="close-info-modal" aria-label="Close">&times;</button>
            
            <div class="modal-header">
                <h2 class="modal-title">About Wisdom Meter Pro</h2>
                <p class="modal-description">Understanding how the Wisdom Meter Pro works</p>
            </div>
            
            <div class="modal-body">
                <p>Wisdom Meter Pro is an advanced self-reflection tool that helps you assess your daily actions and decisions through a series of reflective questions. Each question focuses on key aspects of wisdom, encouraging self-discipline, empathy, and thoughtful decision-making.</p>
                
                <h3 class="text-lg font-semibold mt-4 mb-2">How It Works</h3>
                <p>Answer the ten questions by setting the slider on a scale from 1 (low) to 5 (high). After completing the assessment, Wisdom Meter Pro calculates your wisdom score and provides detailed insights into your strengths and areas for improvement.</p>
                
                <h3 class="text-lg font-semibold mt-4 mb-2">Wisdom Categories</h3>
                <ul class="space-y-2">
                    <li><span class="font-medium">Rational Thinking:</span> The ability to weigh consequences and make informed decisions.</li>
                    <li><span class="font-medium">Emotional Balance:</span> The ability to stay calm in stressful situations.</li>
                    <li><span class="font-medium">Empathy:</span> Understanding the perspectives and feelings of others.</li>
                    <li><span class="font-medium">Self-Reflection:</span> The willingness to reflect on your own thoughts and actions.</li>
                    <li><span class="font-medium">Ethical Behavior:</span> Following moral principles in your decisions.</li>
                </ul>
                
                <h3 class="text-lg font-semibold mt-4 mb-2">Benefits of Regular Use</h3>
                <p>Through regular self-reflection with Wisdom Meter Pro, you can:</p>
                <ul class="space-y-2">
                    <li>Identify patterns in your thinking and behavior</li>
                    <li>Recognize areas where you can grow</li>
                    <li>Track your progress over time</li>
                    <li>Receive personalized recommendations to enhance your wisdom</li>
                    <li>Develop a deeper understanding of your own values and principles</li>
                </ul>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-primary" id="close-info-btn">Got It</button>
            </div>
        </div>
    </div>

    <!-- Details Modal -->
    <div class="modal-overlay" id="details-modal">
        <div class="modal-content">
            <button class="close-button" id="close-details-modal" aria-label="Close">&times;</button>
            
            <div class="modal-header">
                <h2 class="modal-title">Detailed Results</h2>
                <p class="modal-description">Complete breakdown of your wisdom assessment</p>
            </div>
            
            <div class="modal-body">
                <div class="mb-4">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-lg font-semibold">Overall Result</h3>
                        <div class="badge badge-primary" id="modal-result-score">0%</div>
                    </div>
                    <p id="modal-result-message"></p>
                </div>
                
                <h3 class="text-lg font-semibold mb-2">Category Breakdown</h3>
                <div id="category-breakdown">
                    <!-- Will be filled by JavaScript -->
                </div>
                
                <h3 class="text-lg font-semibold mt-6 mb-2">Personal Notes</h3>
                <div class="card p-4 bg-card" id="modal-personal-notes">
                    <p class="text-muted">No notes added.</p>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-outline" id="print-details-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 6 2 18 2 18 9"></polyline>
                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                        <rect x="6" y="14" width="12" height="8"></rect>
                    </svg>
                    Print
                </button>
                <button class="btn btn-outline" id="share-details-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="18" cy="5" r="3"></circle>
                        <circle cx="6" cy="12" r="3"></circle>
                        <circle cx="18" cy="19" r="3"></circle>
                        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                    </svg>
                    Share
                </button>
                <button class="btn btn-primary" id="close-details-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" id="delete-modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 class="modal-title">Clear History</h2>
                <p class="modal-description">Are you sure you want to clear your entire wisdom history?</p>
            </div>
            
            <div class="modal-body">
                <p class="text-danger">Warning: This action cannot be undone. All your previous wisdom assessments will be permanently deleted.</p>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-delete-btn">Cancel</button>
                <button class="btn btn-danger" id="confirm-delete-btn">Confirm Delete</button>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div class="modal-overlay" id="share-modal">
        <div class="modal-content" style="max-width: 400px;">
            <button class="close-button" id="close-share-modal" aria-label="Close">&times;</button>
            
            <div class="modal-header">
                <h2 class="modal-title">Share Your Results</h2>
                <p class="modal-description">Choose how you want to share your wisdom assessment</p>
            </div>
            
            <div class="modal-body">
                <div class="share-options">
                    <div class="share-option" id="share-twitter">
                        <div class="share-option-icon" style="background: rgba(29, 161, 242, 0.1); color: #1DA1F2;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"></path>
                            </svg>
                        </div>
                        <div class="share-option-label">Twitter</div>
                    </div>
                    <div class="share-option" id="share-facebook">
                        <div class="share-option-icon" style="background: rgba(66, 103, 178, 0.1); color: #4267B2;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
                            </svg>
                        </div>
                        <div class="share-option-label">Facebook</div>
                    </div>
                    <div class="share-option" id="share-linkedin">
                        <div class="share-option-icon" style="background: rgba(0, 119, 181, 0.1); color: #0077B5;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
                                <rect x="2" y="9" width="4" height="12"></rect>
                                <circle cx="4" cy="4" r="2"></circle>
                            </svg>
                        </div>
                        <div class="share-option-label">LinkedIn</div>
                    </div>
                </div>
                
                <div class="mt-6">
                    <label class="form-label">Share Link</label>
                    <div class="share-link">
                        <input type="text" class="share-link-input" id="share-link-input" value="https://wisewords01.com/produkt/wisewords/" readonly>
                        <button class="btn btn-outline" id="copy-link-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                            Copy
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div class="notification-container" id="notification-container">
        <!-- Notifications will be added here dynamically -->
    </div>

    <script>
        // ===== DATA MODELS & STATE =====
        
        // Question categories mapping
        const questionCategories = {
            rationality: { name: "Rational Thinking", description: "Weighing consequences and making informed decisions" },
            calmness: { name: "Emotional Balance", description: "Staying calm in stressful situations" },
            empathy: { name: "Empathy", description: "Understanding the perspectives and feelings of others" },
            reflection: { name: "Self-Reflection", description: "Reflecting on your own thoughts and actions" },
            kindness: { name: "Kindness", description: "Showing compassion and goodwill toward others" },
            adaptability: { name: "Adaptability", description: "Flexibility with unexpected changes" },
            ethics: { name: "Ethical Behavior", description: "Following moral principles in decisions" },
            learning: { name: "Learning", description: "Openness to new knowledge and insights" },
            meaning: { name: "Meaning-Seeking", description: "Pursuing purpose in actions" },
            presence: { name: "Mindfulness", description: "Being present in the moment" }
        };
        
        // Wisdom practices
        const wisdomPractices = [
            "Take 5 minutes today to sit in silence and observe your breath.",
            "Listen actively to someone today without interrupting or immediately responding.",
            "Write down three things you're grateful for today.",
            "Before making an important decision, ask yourself: 'How will this decision affect me in one year?'",
            "Practice compassion by helping someone without expecting anything in return.",
            "Reflect on a recent situation where you reacted emotionally. How could you have responded differently?",
            "Look for beauty in everyday things that you normally overlook.",
            "Challenge your assumptions about a situation or person and try to see a new perspective.",
            "Practice patience in a situation that normally frustrates you.",
            "Take time to reflect on your core values and how you express them in your actions today."
        ];
        
        // Recommendations based on categories
        const categoryRecommendations = {
            rationality: [
                "Practice weighing pros and cons when making decisions.",
                "Consider the long-term consequences of your actions.",
                "Question your own assumptions and look for counterarguments."
            ],
            calmness: [
                "Practice regular breathing exercises to reduce stress.",
                "Take deliberate breaks during hectic situations.",
                "Develop strategies to step back in emotional moments."
            ],
            empathy: [
                "Practice active listening without immediately judging.",
                "Try to see situations from others' perspectives.",
                "Ask open-ended questions to deepen your understanding of others."
            ],
            reflection: [
                "Keep a reflection journal about your daily experiences.",
                "Set aside regular time for self-reflection without distractions.",
                "Question your motivations and emotional reactions."
            ],
            kindness: [
                "Practice small acts of kindness daily.",
                "Offer support without expecting anything in return.",
                "Practice compassion even in difficult encounters."
            ],
            adaptability: [
                "Deliberately expose yourself to new challenges.",
                "Practice seeing changes as opportunities rather than threats.",
                "Develop flexibility in your routines and thinking."
            ],
            ethics: [
                "Reflect on your core values and how they guide your decisions.",
                "Practice integrity even in small, everyday decisions.",
                "Examine ethical dilemmas from multiple perspectives."
            ],
            learning: [
                "Dedicate daily time to acquiring new knowledge.",
                "Ask questions and stay curious in all areas of life.",
                "Look for learning opportunities in challenges and mistakes."
            ],
            meaning: [
                "Reflect on the deeper purpose of your daily activities.",
                "Connect your actions to your long-term goals and values.",
                "Look for opportunities to make a positive difference."
            ],
            presence: [
                "Practice mindfulness exercises in everyday activities.",
                "Reduce multitasking and focus fully on one task.",
                "Consciously notice your surroundings and sensory experiences."
            ]
        };
        
        // Application state
        let appState = {
            currentView: 'dashboard',
            currentStep: 1,
            currentTab: 'trends',
            currentPeriod: 'week',
            currentCompare: 'previous',
            lastAssessment: null,
            wisdomHistory: [],
            charts: {},
            darkMode: false,
            colorScheme: 'blue',
            notifications: {
                enabled: false,
                reminder: false,
                reminderTime: '20:00'
            }
        };
        
        // ===== UTILITY FUNCTIONS =====
        
        // Format date based on period
        function formatDate(date, period = 'day') {
            const options = { hour: '2-digit', minute: '2-digit' };
            
            switch (period) {
                case 'day':
                    return date.toLocaleTimeString([], options);
                case 'week':
                    return date.toLocaleDateString([], { weekday: 'short', day: 'numeric', month: 'short' });
                case 'month':
                    return date.toLocaleDateString([], { day: 'numeric', month: 'short' });
                case 'year':
                    return date.toLocaleDateString([], { month: 'short', year: '2-digit' });
                default:
                    return date.toLocaleDateString([], { day: 'numeric', month: 'short', year: 'numeric' });
            }
        }
        
        // Filter data by time period
        function filterDataByPeriod(data, period) {
            if (!data || !data.length) return [];
            
            const now = new Date();
            let cutoffDate = new Date();
            
            switch (period) {
                case 'day':
                    cutoffDate.setHours(now.getHours() - 24);
                    break;
                case 'week':
                    cutoffDate.setDate(now.getDate() - 7);
                    break;
                case 'month':
                    cutoffDate.setMonth(now.getMonth() - 1);
                    break;
                case 'year':
                    cutoffDate.setFullYear(now.getFullYear() - 1);
                    break;
                case 'all':
                default:
                    cutoffDate = new Date(0); // All data
            }
            
            return data.filter(entry => new Date(entry.date) >= cutoffDate);
        }
        
        // Get random item from array
        function getRandomItem(array) {
            return array[Math.floor(Math.random() * array.length)];
        }
        
        // Calculate average of array
        function calculateAverage(array) {
            if (!array || !array.length) return 0;
            return array.reduce((sum, value) => sum + value, 0) / array.length;
        }
        
        // Export data to CSV
        function exportToCSV(data, filename) {
            // Create CSV header
            const header = ['Date', 'Wisdom Score'];
            
            // Add question categories to header
            Object.keys(questionCategories).forEach(category => {
                header.push(questionCategories[category].name);
            });
            
            header.push('Notes');
            
            // Create CSV rows
            const rows = data.map(entry => {
                const row = [
                    new Date(entry.date).toLocaleString(),
                    entry.score.toFixed(2) + '%'
                ];
                
                // Add question scores
                Object.keys(questionCategories).forEach((category, index) => {
                    row.push(entry.questionScores[index]);
                });
                
                // Add notes
                row.push(entry.notes || '');
                
                return row;
            });
            
            // Combine header and rows
            const csvContent = [header, ...rows]
                .map(row => row.map(cell => `"${cell}"`).join(','))
                .join('\n');
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', filename || 'wisdom-data.csv');
            link.style.display = 'none';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Export data to JSON
        function exportToJSON(data, filename) {
            const jsonContent = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonContent], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', filename || 'wisdom-data.json');
            link.style.display = 'none';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Show notification
        function showNotification(title, message, type = 'info', duration = 5000) {
            const notificationContainer = document.getElementById('notification-container');
            
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            
            // Set notification content
            notification.innerHTML = `
                <div class="notification-icon">
                    ${getNotificationIcon(type)}
                </div>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
                <button class="notification-close" aria-label="Close notification">&times;</button>
            `;
            
            // Add to container
            notificationContainer.appendChild(notification);
            
            // Add event listener to close button
            notification.querySelector('.notification-close').addEventListener('click', () => {
                notification.remove();
            });
            
            // Auto-remove after duration
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, duration);
        }
        
        function getNotificationIcon(type) {
            switch (type) {
                case 'success':
                    return `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>`;
                case 'warning':
                    return `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f97316" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                        <line x1="12" y1="9" x2="12" y2="13"></line>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>`;
                case 'error':
                    return `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="15" y1="9" x2="9" y2="15"></line>
                        <line x1="9" y1="9" x2="15" y2="15"></line>
                    </svg>`;
                case 'info':
                default:
                    return `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>`;
            }
        }
        
        // Generate calendar
        function generateCalendar(year, month) {
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();
            
            const calendarContainer = document.getElementById('wisdom-calendar');
            const calendarTitle = document.getElementById('calendar-title');
            
            // Clear existing calendar days (except weekday headers)
            const weekdayHeaders = Array.from(calendarContainer.querySelectorAll('.calendar-weekday'));
            calendarContainer.innerHTML = '';
            weekdayHeaders.forEach(header => calendarContainer.appendChild(header));
            
            // Set calendar title
            calendarTitle.textContent = firstDay.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
            
            // Add empty cells for days before the first day of the month
            for (let i = 0; i < startingDayOfWeek; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                emptyDay.style.opacity = '0.3';
                calendarContainer.appendChild(emptyDay);
            }
            
            // Add days of the month
            const today = new Date();
            const assessmentDates = appState.wisdomHistory.map(entry => {
                const date = new Date(entry.date);
                return `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;
            });
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dateString = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;
                const hasEntry = assessmentDates.includes(dateString);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                
                // Check if this is today
                if (date.getDate() === today.getDate() && 
                    date.getMonth() === today.getMonth() && 
                    date.getFullYear() === today.getFullYear()) {
                    dayElement.classList.add('today');
                }
                
                // Check if this day has an assessment
                if (hasEntry) {
                    dayElement.classList.add('has-entry');
                    dayElement.dataset.date = dateString;
                    dayElement.addEventListener('click', () => showDayDetails(dateString));
                }
                
                dayElement.innerHTML = `
                    <div class="calendar-day-number">${day}</div>
                    <div class="calendar-day-indicator"></div>
                `;
                
                calendarContainer.appendChild(dayElement);
            }
        }
        
        // Show day details
        function showDayDetails(dateString) {
            const [year, month, day] = dateString.split('-').map(Number);
            const entries = appState.wisdomHistory.filter(entry => {
                const date = new Date(entry.date);
                return date.getFullYear() === year && 
                       date.getMonth() === month && 
                       date.getDate() === day;
            });
            
            if (entries.length === 0) return;
            
            // Sort by time (newest first)
            entries.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            const detailsContainer = document.getElementById('selected-day-details');
            const entry = entries[0]; // Get the most recent entry for that day
            
            // Format date
            const date = new Date(entry.date);
            const formattedDate = date.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Find strengths and areas for improvement
            const strengths = [];
            const improvements = [];
            
            entry.questionScores.forEach((score, index) => {
                const categoryId = Object.keys(questionCategories)[index];
                const category = questionCategories[categoryId];
                
                if (score >= 4) {
                    strengths.push(category.name);
                } else if (score <= 2) {
                    improvements.push(category.name);
                }
            });
            
            // Generate HTML
            detailsContainer.innerHTML = `
                <div class="mb-4">
                    <h4 class="font-semibold">${formattedDate}</h4>
                    <div class="flex items-center gap-2 mt-2">
                        <span>Wisdom Score:</span>
                        <span class="badge ${getBadgeClass(entry.score)}">${entry.score.toFixed(2)}%</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                    <div>
                        <h5 class="font-medium mb-2">Strengths</h5>
                        <div>${strengths.length ? strengths.join(', ') : 'No specific strengths'}</div>
                    </div>
                    <div>
                        <h5 class="font-medium mb-2">Areas for Improvement</h5>
                        <div>${improvements.length ? improvements.join(', ') : 'No specific areas for improvement'}</div>
                    </div>
                </div>
                
                ${entry.notes ? `
                <div class="mt-4">
                    <h5 class="font-medium mb-2">Notes</h5>
                    <div class="p-3 bg-card-hover rounded-md">${entry.notes}</div>
                </div>
                ` : ''}
                
                <div class="flex justify-end mt-4">
                    <button class="btn btn-outline btn-sm view-entry-btn" data-date="${entry.date}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        View Full Details
                    </button>
                </div>
            `;
            
            // Add event listener to view button
            detailsContainer.querySelector('.view-entry-btn').addEventListener('click', function() {
                const date = this.dataset.date;
                const entry = appState.wisdomHistory.find(e => e.date === date);
                if (entry) {
                    viewHistoryEntry(entry);
                }
            });
        }
        
        // ===== INITIALIZATION =====
        
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved data
            loadSavedData();
            
            // Set up all sliders
            initializeSliders();
            
            // Set up event listeners
            setupEventListeners();
            
            // Initialize charts
            if (appState.wisdomHistory.length > 0) {
                initializeCharts();
            }
            
            // Set random wisdom practice
            document.getElementById('daily-wisdom-practice').textContent = getRandomItem(wisdomPractices);
            
            // Check for dark mode preference
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                toggleDarkMode();
            }
            
            // Initialize calendar
            const now = new Date();
            generateCalendar(now.getFullYear(), now.getMonth());
            
            // Check for notification permission
            if ('Notification' in window) {
                if (Notification.permission === 'granted') {
                    appState.notifications.enabled = true;
                }
            }
            
            // Set up reminder settings
            document.getElementById('enable-reminder').checked = appState.notifications.reminder;
            document.getElementById('reminder-time').value = appState.notifications.reminderTime;
            
            // Show notification container
            if (appState.notifications.reminder) {
                document.getElementById('reminder-time-container').style.display = 'block';
            } else {
                document.getElementById('reminder-time-container').style.display = 'none';
            }
            
            // Show welcome notification
            setTimeout(() => {
                showNotification(
                    'Welcome to Wisdom Meter Pro',
                    'Track and analyze your wisdom development with our advanced tools.',
                    'info',
                    6000
                );
            }, 1000);
        });
        
        // Initialize sliders
        function initializeSliders() {
            const sliders = document.querySelectorAll('.slider');
            sliders.forEach(slider => {
                updateSliderProgress(slider);
                
                // Update progress and value indicator when slider changes
                slider.addEventListener('input', function() {
                    updateSliderProgress(this);
                    updateValueIndicator(this);
                });
                
                // Show value indicator on hover/focus
                slider.addEventListener('mouseenter', function() {
                    showValueIndicator(this);
                });
                
                slider.addEventListener('mouseleave', function() {
                    hideValueIndicator(this);
                });
                
                slider.addEventListener('focus', function() {
                    showValueIndicator(this);
                });
                
                slider.addEventListener('blur', function() {
                    hideValueIndicator(this);
                });
                
                // Touch events for mobile
                slider.addEventListener('touchstart', function() {
                    showValueIndicator(this);
                });
                
                slider.addEventListener('touchend', function() {
                    hideValueIndicator(this);
                });
            });
        }
        
        // Update slider progress bar
        function updateSliderProgress(slider) {
            const id = slider.id;
            const value = slider.value;
            const min = slider.min || 1;
            const max = slider.max || 5;
            const progressElement = document.getElementById(`progress-${id}`);
            
            if (progressElement) {
                const percentage = ((value - min) / (max - min)) * 100;
                progressElement.style.width = `${percentage}%`;
            }
            
            // Update aria attribute for accessibility
            slider.setAttribute('aria-valuenow', value);
            
            // Update value indicator
            updateValueIndicator(slider);
        }
        
        // Update value indicator
        function updateValueIndicator(slider) {
            const id = slider.id;
            const value = slider.value;
            const valueIndicator = document.getElementById(`value-${id}`);
            
            if (valueIndicator) {
                valueIndicator.textContent = value;
                
                // Position the indicator
                const percentage = ((value - slider.min) / (slider.max - slider.min)) * 100;
                valueIndicator.style.left = `calc(${percentage}% + (${8 - percentage * 0.16}px))`;
            }
        }
        
        // Show value indicator
        function showValueIndicator(slider) {
            const id = slider.id;
            const valueIndicator = document.getElementById(`value-${id}`);
            
            if (valueIndicator) {
                valueIndicator.style.opacity = '1';
                valueIndicator.style.top = '-30px';
            }
        }
        
        // Hide value indicator
        function hideValueIndicator(slider) {
            const id = slider.id;
            const valueIndicator = document.getElementById(`value-${id}`);
            
            if (valueIndicator) {
                valueIndicator.style.opacity = '0';
                valueIndicator.style.top = '0';
            }
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Form submission
            document.getElementById('wisdom-form').addEventListener('submit', handleFormSubmit);
            
            // Navigation
            document.getElementById('history-nav').addEventListener('click', showHistoryView);
            document.getElementById('insights-nav').addEventListener('click', showInsightsSection);
            document.getElementById('settings-nav').addEventListener('click', showSettingsView);
            document.getElementById('back-to-dashboard').addEventListener('click', showDashboardView);
            document.getElementById('back-to-dashboard-from-settings').addEventListener('click', showDashboardView);
            
            // Mobile navigation
            document.getElementById('mobile-menu-toggle').addEventListener('click', toggleMobileMenu);
            document.getElementById('mobile-menu-close').addEventListener('click', toggleMobileMenu);
            document.getElementById('mobile-history-nav').addEventListener('click', () => {
                showHistoryView();
                toggleMobileMenu();
            });
            document.getElementById('mobile-insights-nav').addEventListener('click', () => {
                showInsightsSection();
                toggleMobileMenu();
            });
            document.getElementById('mobile-settings-nav').addEventListener('click', () => {
                showSettingsView();
                toggleMobileMenu();
            });
            
            // Modals
            document.getElementById('info-button').addEventListener('click', showInfoModal);
            document.getElementById('close-info-modal').addEventListener('click', hideInfoModal);
            document.getElementById('close-info-btn').addEventListener('click', hideInfoModal);
            
            document.getElementById('view-details-btn').addEventListener('click', showDetailsModal);
            document.getElementById('close-details-modal').addEventListener('click', hideDetailsModal);
            document.getElementById('close-details-btn').addEventListener('click', hideDetailsModal);
            document.getElementById('share-details-btn').addEventListener('click', showShareModal);
            
            document.getElementById('clear-history').addEventListener('click', showDeleteModal);
            document.getElementById('cancel-delete-btn').addEventListener('click', hideDeleteModal);
            document.getElementById('confirm-delete-btn').addEventListener('click', clearHistory);
            
            document.getElementById('share-results').addEventListener('click', showShareModal);
            document.getElementById('close-share-modal').addEventListener('click', hideShareModal);
            document.getElementById('copy-link-btn').addEventListener('click', copyShareLink);
            
            // Social sharing
            document.getElementById('share-twitter').addEventListener('click', shareToTwitter);
            document.getElementById('share-facebook').addEventListener('click', shareToFacebook);
            document.getElementById('share-linkedin').addEventListener('click', shareToLinkedIn);
            
            // Tab switching
            const tabTriggers = document.querySelectorAll('.tab-trigger');
            tabTriggers.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    switchTab(tabId);
                });
            });
            
            // Period switching
            const periodButtons = document.querySelectorAll('.period-btn');
            periodButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const period = this.dataset.period;
                    switchPeriod(period);
                });
            });
            
            // Comparison switching
            const compareButtons = document.querySelectorAll('.compare-btn');
            compareButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const compare = this.dataset.compare;
                    switchCompare(compare);
                });
            });
            
            // Calendar navigation
            document.getElementById('prev-month').addEventListener('click', navigateToPreviousMonth);
            document.getElementById('next-month').addEventListener('click', navigateToNextMonth);
            
            // Settings
            document.getElementById('theme-toggle').addEventListener('click', toggleDarkMode);
            
            const themeOptions = document.querySelectorAll('.theme-option');
            themeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const theme = this.dataset.theme;
                    setTheme(theme);
                    
                    // Update active state
                    themeOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            const colorOptions = document.querySelectorAll('.color-option');
            colorOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const color = this.dataset.color;
                    setColorScheme(color);
                    
                    // Update active state
                    colorOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Reminder toggle
            document.getElementById('enable-reminder').addEventListener('change', function() {
                appState.notifications.reminder = this.checked;
                saveSettings();
                
                // Show/hide time input
                document.getElementById('reminder-time-container').style.display = this.checked ? 'block' : 'none';
                
                // Show notification
                if (this.checked) {
                    showNotification(
                        'Reminder Enabled',
                        `You'll be reminded to complete your wisdom assessment at ${document.getElementById('reminder-time').value}.`,
                        'success'
                    );
                } else {
                    showNotification(
                        'Reminder Disabled',
                        'Daily wisdom assessment reminders have been turned off.',
                        'info'
                    );
                }
            });
            
            // Reminder time change
            document.getElementById('reminder-time').addEventListener('change', function() {
                appState.notifications.reminderTime = this.value;
                saveSettings();
                
                showNotification(
                    'Reminder Time Updated',
                    `Your daily reminder is now set for ${this.value}.`,
                    'success'
                );
            });
            
            // Enable notifications
            document.getElementById('enable-notifications').addEventListener('click', requestNotificationPermission);
            
            // Data management
            document.getElementById('export-json').addEventListener('click', () => {
                exportToJSON(appState.wisdomHistory, 'wisdom-meter-data.json');
                showNotification('Export Complete', 'Your data has been exported as JSON.', 'success');
            });
            
            document.getElementById('export-csv').addEventListener('click', () => {
                exportToCSV(appState.wisdomHistory, 'wisdom-meter-data.csv');
                showNotification('Export Complete', 'Your data has been exported as CSV.', 'success');
            });
            
            document.getElementById('export-pdf').addEventListener('click', () => {
                showNotification('Generating PDF', 'Your PDF report is being generated...', 'info');
                setTimeout(() => {
                    showNotification('Export Complete', 'Your PDF report has been downloaded.', 'success');
                }, 2000);
            });
            
            document.getElementById('backup-data').addEventListener('click', backupData);
            document.getElementById('restore-data').addEventListener('click', restoreData);
            document.getElementById('clear-all-data').addEventListener('click', confirmClearAllData);
            
            // Other buttons
            document.getElementById('export-data').addEventListener('click', exportData);
            document.getElementById('print-results').addEventListener('click', printResults);
            document.getElementById('export-history').addEventListener('click', exportHistory);
            document.getElementById('print-details-btn').addEventListener('click', printDetails);
            document.getElementById('new-practice-btn').addEventListener('click', newWisdomPractice);
            document.getElementById('save-practice-btn').addEventListener('click', savePractice);
            
            // History search
            document.getElementById('history-search').addEventListener('input', filterHistoryTable);
            
            // Chart actions
            document.getElementById('refresh-chart').addEventListener('click', refreshCharts);
            document.getElementById('download-chart').addEventListener('click', downloadChart);
        }
        
        // Load saved data from localStorage
        function loadSavedData() {
            // Load wisdom history
            const savedData = localStorage.getItem('wisdomHistory');
            if (savedData) {
                try {
                    appState.wisdomHistory = JSON.parse(savedData);
                    
                    // If we have history data, update the UI
                    if (appState.wisdomHistory.length > 0) {
                        updateHistoryTable();
                        
                        // Set last assessment
                        appState.lastAssessment = [...appState.wisdomHistory]
                            .sort((a, b) => new Date(b.date) - new Date(a.date))[0];
                    }
                } catch (e) {
                    console.error('Failed to parse saved wisdom data', e);
                    appState.wisdomHistory = [];
                }
            }
            
            // Load settings
            const savedSettings = localStorage.getItem('wisdomSettings');
            if (savedSettings) {
                try {
                    const settings = JSON.parse(savedSettings);
                    
                    // Apply saved settings
                    if (settings.darkMode !== undefined) {
                        appState.darkMode = settings.darkMode;
                        if (appState.darkMode) {
                            document.documentElement.classList.add('dark');
                            updateThemeToggleIcon(true);
                        }
                    }
                    
                    if (settings.colorScheme) {
                        appState.colorScheme = settings.colorScheme;
                        applyColorScheme(settings.colorScheme);
                    }
                    
                    if (settings.notifications) {
                        appState.notifications = {
                            ...appState.notifications,
                            ...settings.notifications
                        };
                    }
                    
                } catch (e) {
                    console.error('Failed to parse saved settings', e);
                }
            }
        }
        
        // Save settings to localStorage
        function saveSettings() {
            const settings = {
                darkMode: appState.darkMode,
                colorScheme: appState.colorScheme,
                notifications: appState.notifications
            };
            
            localStorage.setItem('wisdomSettings', JSON.stringify(settings));
        }
        











































        // ===== FORM HANDLING =====
        
        // Handle form submission
        function handleFormSubmit(event) {
            event.preventDefault();
            
            // Get all question IDs
            const questionIds = Object.keys(questionCategories);
            
            // Create an array with the values of the range inputs
            const scores = questionIds.map(id => parseInt(document.getElementById(id).value));
            
            // Get notes
            const notes = document.getElementById('personal-notes').value;
            
            // Calculate average and percentage
            const total = scores.reduce((acc, curr) => acc + curr, 0);
            const average = total / scores.length;
            const percentage = ((average - 1) / 4) * 100; // Convert 1-5 scale to 0-100%
            
            // Create assessment object
            const assessment = {
                date: new Date().toISOString(),
                score: percentage,
                questionScores: scores,
                notes: notes
            };
            
            // Save to state
            appState.lastAssessment = assessment;
            
            // Save to history
            appState.wisdomHistory.push(assessment);
            
            // Save to localStorage
            localStorage.setItem('wisdomHistory', JSON.stringify(appState.wisdomHistory));
            
            // Update UI
            updateResults(assessment);
            showResultsSection();
            updateHistoryTable();
            
            // Initialize or update charts
            if (!appState.charts.trends) {
                initializeCharts();
            } else {
                updateCharts();
            }
            
            // Update progress steps
            document.getElementById('step-1').classList.remove('active');
            document.getElementById('step-1').classList.add('completed');
            document.getElementById('step-2').classList.add('active');
            
            // Show success notification
            showNotification(
                'Assessment Complete',
                `Your wisdom score is ${percentage.toFixed(2)}%. View your detailed results.`,
                'success'
            );
            
            // Update calendar if visible
            if (document.getElementById('tab-calendar').classList.contains('active')) {
                const now = new Date();
                generateCalendar(now.getFullYear(), now.getMonth());
            }
        }
        
        // Update results display
        function updateResults(assessment) {
            // Update gauge
            updateGauge(assessment.score);
            
            // Set result category badge
            const categoryBadge = document.getElementById('result-category');
            let category = '';
            
            if (assessment.score < 30) {
                category = 'Beginner';
                categoryBadge.className = 'badge badge-warning mb-2';
            } else if (assessment.score < 50) {
                category = 'Developing';
                categoryBadge.className = 'badge badge-primary mb-2';
            } else if (assessment.score < 70) {
                category = 'Advanced';
                categoryBadge.className = 'badge badge-secondary mb-2';
            } else if (assessment.score < 90) {
                category = 'Experienced';
                categoryBadge.className = 'badge badge-accent mb-2';
            } else {
                category = 'Master';
                categoryBadge.className = 'badge badge-success mb-2';
            }
            
            categoryBadge.textContent = category;
            
            // Set result message
            let message = '';
            if (assessment.score < 30) {
                message = 'You\'re at the beginning of your wisdom journey. With regular reflection and practice, you will grow.';
            } else if (assessment.score < 50) {
                message = 'You\'re developing wisdom in some areas of life. Stay curious and open to further growth.';
            } else if (assessment.score < 70) {
                message = 'You\'re making wise choices in many situations. Your self-reflection is bearing fruit.';
            } else if (assessment.score < 90) {
                message = 'Your wisdom is impressive and guides many of your actions. You\'re a role model for others.';
            } else {
                message = 'You\'ve achieved an extraordinary level of wisdom in your daily life. Share your insights with others!';
            }
            
            document.getElementById('result-message').textContent = message;
            
            // Identify strengths and improvement areas
            const strengths = [];
            const improvements = [];
            
            assessment.questionScores.forEach((score, index) => {
                const categoryId = Object.keys(questionCategories)[index];
                const category = questionCategories[categoryId];
                
                if (score >= 4) {
                    strengths.push(`<div class="mb-1"><span class="text-success">●</span> ${category.name}</div>`);
                } else if (score <= 2) {
                    improvements.push(`<div class="mb-1"><span class="text-warning">●</span> ${category.name}</div>`);
                }
            });
            
            // Update strengths and improvements
            document.getElementById('strengths-count').textContent = strengths.length;
            document.getElementById('improvements-count').textContent = improvements.length;
            
            document.getElementById('strengths-list').innerHTML = strengths.length ? 
                strengths.join('') : 
                '<div class="text-muted">No specific strengths identified.</div>';
            
            document.getElementById('improvements-list').innerHTML = improvements.length ? 
                improvements.join('') : 
                '<div class="text-muted">No specific areas for improvement identified.</div>';
            
            // Update modal content
            document.getElementById('modal-result-score').textContent = `${assessment.score.toFixed(2)}%`;
            document.getElementById('modal-result-message').textContent = message;
            
            // Update category breakdown in modal
            const categoryBreakdown = document.getElementById('category-breakdown');
            categoryBreakdown.innerHTML = '';
            
            assessment.questionScores.forEach((score, index) => {
                const categoryId = Object.keys(questionCategories)[index];
                const category = questionCategories[categoryId];
                const percentage = ((score - 1) / 4) * 100;
                
                let colorClass = 'bg-warning';
                if (percentage >= 75) colorClass = 'bg-success';
                else if (percentage >= 50) colorClass = 'bg-primary';
                else if (percentage >= 25) colorClass = 'bg-secondary';
                
                const html = `
                    <div class="mb-3">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-medium">${category.name}</span>
                            <span class="text-sm">${score}/5</span>
                        </div>
                        <div class="w-full bg-card-hover rounded-full h-2">
                            <div class="${colorClass} h-2 rounded-full" style="width: ${percentage}%"></div>
                        </div>
                        <div class="text-xs text-muted mt-1">${category.description}</div>
                    </div>
                `;
                
                categoryBreakdown.innerHTML += html;
            });
            
            // Update personal notes in modal
            const modalNotes = document.getElementById('modal-personal-notes');
            if (assessment.notes && assessment.notes.trim()) {
                modalNotes.innerHTML = `<p>${assessment.notes}</p>`;
            } else {
                modalNotes.innerHTML = '<p class="text-muted">No notes added.</p>';
            }
            
            // Generate recommendations
            generateRecommendations(assessment);
        }
        
        // Update gauge with animation
        // Update gauge with animation
        function updateGauge(percentage) {
            const gaugeProgress = document.getElementById('gauge-progress');
            const gaugeValue = document.getElementById('gauge-value');
            
            // Calculate the stroke-dasharray
            // Circumference = 2 * PI * r = 2 * 3.14 * 40 ≈ 251.2
            const circumference = 2 * Math.PI * 40;
            const progressValue = (percentage / 100) * circumference;
            const remainingValue = circumference - progressValue;
            
            // Set the new stroke-dasharray
            gaugeProgress.style.strokeDasharray = `${progressValue} ${remainingValue}`;
            
            // Animate the percentage text
            animateNumber(gaugeValue, 0, Math.round(percentage), 1500);
        }
        
        // Animate number counting up
        function animateNumber(element, start, end, duration) {
            let startTime = null;
            
            function animate(timestamp) {
                if (!startTime) startTime = timestamp;
                const progress = Math.min((timestamp - startTime) / duration, 1);
                
                // Easing function for smoother animation
                const easeOutQuad = t => t * (2 - t);
                const easedProgress = easeOutQuad(progress);
                
                const value = Math.floor(start + easedProgress * (end - start));
                element.textContent = `${value}%`;
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    element.textContent = `${end}%`;
                }
            }
            
            requestAnimationFrame(animate);
        }
        
        // Generate recommendations based on assessment
        function generateRecommendations(assessment) {
            const recommendationsContainer = document.getElementById('recommendations-container');
            recommendationsContainer.innerHTML = '';
            
            // Find lowest scoring categories (scores <= 3)
            const lowestCategories = assessment.questionScores
                .map((score, index) => ({ 
                    score, 
                    categoryId: Object.keys(questionCategories)[index],
                    category: questionCategories[Object.keys(questionCategories)[index]]
                }))
                .filter(item => item.score <= 3)
                .sort((a, b) => a.score - b.score)
                .slice(0, 3);
            
            if (lowestCategories.length === 0) {
                // If no low scores, show general recommendations
                recommendationsContainer.innerHTML = `
                    <div class="alert alert-success mb-4">
                        <div class="alert-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                <polyline points="22 4 12 14.01 9 11.01"></polyline>
                            </svg>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">Excellent Work!</div>
                            <div class="alert-message">You're showing a high level of wisdom in all areas. Focus on maintaining your strengths and inspiring others.</div>
                        </div>
                    </div>
                    
                    <div class="card p-4 mb-4">
                        <h3 class="text-lg font-semibold mb-2">General Recommendation</h3>
                        <p>Share your wisdom with others and continue seeking opportunities to grow and learn.</p>
                    </div>
                `;
            } else {
                // Show recommendations for lowest categories
                lowestCategories.forEach(item => {
                    const recommendations = categoryRecommendations[item.categoryId];
                    const randomRecommendations = recommendations
                        .sort(() => 0.5 - Math.random())
                        .slice(0, 2);
                    
                    const html = `
                        <div class="card p-4 mb-4">
                            <h3 class="text-lg font-semibold mb-2">For ${item.category.name}</h3>
                            <p class="text-sm text-muted mb-3">${item.category.description}</p>
                            <ul class="space-y-2">
                                ${randomRecommendations.map(rec => `
                                    <li class="flex items-start gap-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-primary mt-1">
                                            <polyline points="9 11 12 14 22 4"></polyline>
                                            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                                        </svg>
                                        <span>${rec}</span>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                    `;
                    
                    recommendationsContainer.innerHTML += html;
                });
            }
        }
        





        // ===== CHARTS =====
        
        // Initialize charts
        function initializeCharts() {
            // Only initialize if we have data
            if (appState.wisdomHistory.length === 0) return;
            
            // Trends chart
            initializeTrendsChart();
            
            // Categories chart
            initializeCategoriesChart();
            
            // Comparison chart
            initializeComparisonChart();
            
            // History chart
            initializeHistoryChart();
        }
        
        // Initialize trends chart
        function initializeTrendsChart() {
            const ctx = document.getElementById('trends-chart').getContext('2d');
            
            // Filter data by current period
            const filteredData = filterDataByPeriod(appState.wisdomHistory, appState.currentPeriod);
            
            // Prepare data
            const labels = filteredData.map(entry => formatDate(new Date(entry.date), appState.currentPeriod));
            const data = filteredData.map(entry => entry.score);
            
            // Create gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, 300);
            gradient.addColorStop(0, 'rgba(14, 165, 233, 0.5)');
            gradient.addColorStop(1, 'rgba(14, 165, 233, 0)');
            
            // Create chart
            appState.charts.trends = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Wisdom Score',
                        data: data,
                        borderColor: '#0ea5e9',
                        backgroundColor: gradient,
                        borderWidth: 2,
                        pointBackgroundColor: '#0ea5e9',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#0ea5e9',
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            enabled: false,
                            external: externalTooltipHandler
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                maxRotation: 45,
                                minRotation: 45
                            }
                        },
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    }
                }
            });
            
            // Update statistics
            updateTrendStatistics(filteredData);
        }
        
        // Initialize categories chart
        function initializeCategoriesChart() {
            const ctx = document.getElementById('categories-chart').getContext('2d');
            
            // Get latest assessment
            const latestAssessment = appState.wisdomHistory[appState.wisdomHistory.length - 1];
            
            // Prepare data
            const labels = Object.values(questionCategories).map(category => category.name);
            const data = latestAssessment.questionScores.map(score => ((score - 1) / 4) * 100);
            
            // Create chart
            appState.charts.categories = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Wisdom Categories',
                        data: data,
                        backgroundColor: 'rgba(139, 92, 246, 0.2)',
                        borderColor: '#8b5cf6',
                        borderWidth: 2,
                        pointBackgroundColor: '#8b5cf6',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#8b5cf6',
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            pointLabels: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                font: {
                                    size: 10
                                }
                            },
                            ticks: {
                                backdropColor: 'transparent',
                                color: 'rgba(255, 255, 255, 0.7)',
                                z: 1,
                                font: {
                                    size: 8
                                }
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
            
            // Update category lists
            updateCategoryLists(latestAssessment);
        }
        
        // Initialize comparison chart
        function initializeComparisonChart() {
            const ctx = document.getElementById('comparison-chart').getContext('2d');
            
            // Get latest assessment
            const latestAssessment = appState.wisdomHistory[appState.wisdomHistory.length - 1];
            
            // Get previous assessment if available
            let previousAssessment = null;
            if (appState.wisdomHistory.length > 1) {
                previousAssessment = appState.wisdomHistory[appState.wisdomHistory.length - 2];
            }
            
            // Prepare data
            const labels = Object.values(questionCategories).map(category => category.name);
            const currentData = latestAssessment.questionScores.map(score => ((score - 1) / 4) * 100);
            const compareData = previousAssessment ? 
                previousAssessment.questionScores.map(score => ((score - 1) / 4) * 100) : 
                Array(labels.length).fill(0);
            
            // Create chart
            appState.charts.comparison = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Current',
                            data: currentData,
                            backgroundColor: '#0ea5e9',
                            borderColor: '#0ea5e9',
                            borderWidth: 1,
                            borderRadius: 4
                        },
                        {
                            label: 'Previous',
                            data: compareData,
                            backgroundColor: 'rgba(139, 92, 246, 0.7)',
                            borderColor: '#8b5cf6',
                            borderWidth: 1,
                            borderRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    }
                }
            });
            
            // Update comparison analysis
            updateComparisonAnalysis(latestAssessment, previousAssessment);
        }
        
        // Initialize history chart
        function initializeHistoryChart() {
            const ctx = document.getElementById('history-chart').getContext('2d');
            
            // Prepare data
            const sortedData = [...appState.wisdomHistory].sort((a, b) => new Date(a.date) - new Date(b.date));
            const labels = sortedData.map(entry => formatDate(new Date(entry.date), 'all'));
            const data = sortedData.map(entry => entry.score);
            
            // Create gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, 300);
            gradient.addColorStop(0, 'rgba(14, 165, 233, 0.5)');
            gradient.addColorStop(1, 'rgba(14, 165, 233, 0)');
            
            // Create chart
            appState.charts.history = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Wisdom Score',
                        data: data,
                        borderColor: '#0ea5e9',
                        backgroundColor: gradient,
                        borderWidth: 2,
                        pointBackgroundColor: '#0ea5e9',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#0ea5e9',
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            enabled: false,
                            external: externalTooltipHandler
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                maxRotation: 45,
                                minRotation: 45
                            }
                        },
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    }
                }
            });
        }
        
        // Update all charts
        function updateCharts() {
            // Only update if we have data
            if (appState.wisdomHistory.length === 0) return;
            
            // Initialize charts if they don't exist
            if (!appState.charts.trends) {
                initializeCharts();
                return;
            }
            
            // Update trends chart
            updateTrendsChart();
            
            // Update categories chart
            updateCategoriesChart();
            
            // Update comparison chart
            updateComparisonChart();
            
            // Update history chart
            updateHistoryChart();
        }
        
        // Update trends chart
        function updateTrendsChart() {
            // Filter data by current period
            const filteredData = filterDataByPeriod(appState.wisdomHistory, appState.currentPeriod);
            
            // Prepare data
            const labels = filteredData.map(entry => formatDate(new Date(entry.date), appState.currentPeriod));
            const data = filteredData.map(entry => entry.score);
            
            // Update chart data
            appState.charts.trends.data.labels = labels;
            appState.charts.trends.data.datasets[0].data = data;
            appState.charts.trends.update();
            
            // Update statistics
            updateTrendStatistics(filteredData);
        }
        
        // Update categories chart
        function updateCategoriesChart() {
            // Get latest assessment
            const latestAssessment = appState.wisdomHistory[appState.wisdomHistory.length - 1];
            
            // Prepare data
            const data = latestAssessment.questionScores.map(score => ((score - 1) / 4) * 100);
            
            // Update chart data
            appState.charts.categories.data.datasets[0].data = data;
            appState.charts.categories.update();
            
            // Update category lists
            updateCategoryLists(latestAssessment);
        }
        
        // Update comparison chart
        function updateComparisonChart() {
            // Get latest assessment
            const latestAssessment = appState.wisdomHistory[appState.wisdomHistory.length - 1];
            
            // Prepare current data
            const currentData = latestAssessment.questionScores.map(score => ((score - 1) / 4) * 100);
            
            // Update current dataset
            appState.charts.comparison.data.datasets[0].data = currentData;
            
            // Prepare comparison data based on selected comparison type
            let compareData = [];
            let compareLabel = '';
            let compareAssessment = null;
            
            switch (appState.currentCompare) {
                case 'previous':
                    compareLabel = 'Previous';
                    if (appState.wisdomHistory.length > 1) {
                        compareAssessment = appState.wisdomHistory[appState.wisdomHistory.length - 2];
                        compareData = compareAssessment.questionScores.map(score => ((score - 1) / 4) * 100);
                    } else {
                        compareData = Array(currentData.length).fill(0);
                    }
                    break;
                    
                case 'average':
                    compareLabel = 'Average';
                    if (appState.wisdomHistory.length > 1) {
                        // Calculate average scores across all assessments
                        const allScores = appState.wisdomHistory.map(entry => entry.questionScores);
                        compareData = [];
                        
                        for (let i = 0; i < currentData.length; i++) {
                            const categoryScores = allScores.map(scores => scores[i]);
                            const average = calculateAverage(categoryScores);
                            compareData.push(((average - 1) / 4) * 100);
                        }
                    } else {
                        compareData = currentData;
                    }
                    break;
                    
                case 'best':
                    compareLabel = 'Best';
                    if (appState.wisdomHistory.length > 1) {
                        // Find assessment with highest overall score
                        const bestAssessment = [...appState.wisdomHistory]
                            .sort((a, b) => b.score - a.score)[0];
                            
                        compareAssessment = bestAssessment;
                        compareData = bestAssessment.questionScores.map(score => ((score - 1) / 4) * 100);
                    } else {
                        compareData = currentData;
                    }
                    break;
                    
                case 'weekly':
                    compareLabel = 'Weekly Avg';
                    if (appState.wisdomHistory.length > 1) {
                        // Calculate weekly average
                        const now = new Date();
                        const oneWeekAgo = new Date(now);
                        oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                        
                        const weeklyData = appState.wisdomHistory.filter(entry => 
                            new Date(entry.date) >= oneWeekAgo && 
                            new Date(entry.date) <= now
                        );
                        
                        if (weeklyData.length > 0) {
                            const allScores = weeklyData.map(entry => entry.questionScores);
                            compareData = [];
                            
                            for (let i = 0; i < currentData.length; i++) {
                                const categoryScores = allScores.map(scores => scores[i]);
                                const average = calculateAverage(categoryScores);
                                compareData.push(((average - 1) / 4) * 100);
                            }
                        } else {
                            compareData = currentData;
                        }
                    } else {
                        compareData = currentData;
                    }
                    break;
            }
            
            // Update comparison dataset
            appState.charts.comparison.data.datasets[1].data = compareData;
            appState.charts.comparison.data.datasets[1].label = compareLabel;
            appState.charts.comparison.update();
            
            // Update comparison analysis
            updateComparisonAnalysis(latestAssessment, compareAssessment);
        }
        
        // Update history chart
        function updateHistoryChart() {
            // Prepare data
            const sortedData = [...appState.wisdomHistory].sort((a, b) => new Date(a.date) - new Date(b.date));
            const labels = sortedData.map(entry => formatDate(new Date(entry.date), 'all'));
            const data = sortedData.map(entry => entry.score);
            
            // Update chart data
            appState.charts.history.data.labels = labels;
            appState.charts.history.data.datasets[0].data = data;
            appState.charts.history.update();
        }
        
        // Update trend statistics
        function updateTrendStatistics(filteredData) {
            if (!filteredData || filteredData.length === 0) {
                document.getElementById('average-score').textContent = '-';
                document.getElementById('highest-score').textContent = '-';
                document.getElementById('trend-indicator').textContent = '-';
                return;
            }
            
            // Calculate average
            const scores = filteredData.map(entry => entry.score);
            const average = calculateAverage(scores);
            document.getElementById('average-score').textContent = `${average.toFixed(2)}%`;
            
            // Find highest score
            const highest = Math.max(...scores);
            document.getElementById('highest-score').textContent = `${highest.toFixed(2)}%`;
            
            // Calculate trend
            let trendIndicator = document.getElementById('trend-indicator');
            if (filteredData.length < 2) {
                trendIndicator.textContent = 'Not enough data';
                trendIndicator.className = 'text-2xl font-bold text-muted';
            } else {
                const firstHalf = filteredData.slice(0, Math.floor(filteredData.length / 2));
                const secondHalf = filteredData.slice(Math.floor(filteredData.length / 2));
                
                const firstAvg = calculateAverage(firstHalf.map(entry => entry.score));
                const secondAvg = calculateAverage(secondHalf.map(entry => entry.score));
                
                const difference = secondAvg - firstAvg;
                
                if (difference > 5) {
                    trendIndicator.textContent = '↗️ Strongly Rising';
                    trendIndicator.className = 'text-2xl font-bold text-success';
                } else if (difference > 1) {
                    trendIndicator.textContent = '↗️ Rising';
                    trendIndicator.className = 'text-2xl font-bold text-primary';
                } else if (difference < -5) {
                    trendIndicator.textContent = '↘️ Strongly Falling';
                    trendIndicator.className = 'text-2xl font-bold text-danger';
                } else if (difference < -1) {
                    trendIndicator.textContent = '↘️ Falling';
                    trendIndicator.className = 'text-2xl font-bold text-warning';
                } else {
                    trendIndicator.textContent = '→ Stable';
                    trendIndicator.className = 'text-2xl font-bold text-secondary';
                }
            }
        }
        
        // Update category lists
        function updateCategoryLists(assessment) {
            // Create array of categories with scores
            const categoryScores = assessment.questionScores.map((score, index) => {
                const categoryId = Object.keys(questionCategories)[index];
                return {
                    id: categoryId,
                    name: questionCategories[categoryId].name,
                    description: questionCategories[categoryId].description,
                    score: score,
                    percentage: ((score - 1) / 4) * 100
                };
            });
            
            // Sort by score
            const sortedCategories = [...categoryScores].sort((a, b) => b.score - a.score);
            
            // Get top and bottom categories
            const topCategories = sortedCategories.slice(0, 3);
            const bottomCategories = sortedCategories.slice(-3).reverse();
            
            // Update top categories list
            const topCategoriesList = document.getElementById('top-categories');
            topCategoriesList.innerHTML = '';
            
            topCategories.forEach(category => {
                const html = `
                    <li class="flex items-start gap-2">
                        <span class="badge badge-success">+</span>
                        <div>
                            <div class="font-medium">${category.name} (${category.score}/5)</div>
                            <div class="text-sm text-muted">${category.description}</div>
                        </div>
                    </li>
                `;
                
                topCategoriesList.innerHTML += html;
            });
            
            // Update bottom categories list
            const bottomCategoriesList = document.getElementById('bottom-categories');
            bottomCategoriesList.innerHTML = '';
            
            bottomCategories.forEach(category => {
                const html = `
                    <li class="flex items-start gap-2">
                        <span class="badge badge-warning">↗</span>
                        <div>
                            <div class="font-medium">${category.name} (${category.score}/5)</div>
                            <div class="text-sm text-muted">${category.description}</div>
                        </div>
                    </li>
                `;
                
                bottomCategoriesList.innerHTML += html;
            });
        }
        
        // Update comparison analysis
        function updateComparisonAnalysis(currentAssessment, compareAssessment) {
            const analysisElement = document.getElementById('comparison-analysis');
            
            if (!compareAssessment) {
                analysisElement.textContent = 'Not enough data for comparison. Complete more wisdom assessments.';
                return;
            }
            
            // Calculate differences
            const currentScores = currentAssessment.questionScores;
            const compareScores = compareAssessment.questionScores;
            
            const improvements = [];
            const declines = [];
            
            currentScores.forEach((score, index) => {
                const categoryId = Object.keys(questionCategories)[index];
                const category = questionCategories[categoryId];
                const diff = score - compareScores[index];
                
                if (diff >= 1) {
                    improvements.push({ category: category.name, diff });
                } else if (diff <= -1) {
                    declines.push({ category: category.name, diff: Math.abs(diff) });
                }
            });
            
            // Generate analysis text
            let analysisText = '';
            
            if (improvements.length === 0 && declines.length === 0) {
                analysisText = 'Your wisdom values have remained stable in comparison. This shows consistency in your thinking and actions.';
            } else {
                if (improvements.length > 0) {
                    analysisText += `You've improved in ${improvements.length} categories: 
                        ${improvements.map(i => `${i.category} (+${i.diff})`).join(', ')}. `;
                }
                
                if (declines.length > 0) {
                    analysisText += `In ${declines.length} categories there's room for improvement: 
                        ${declines.map(d => `${d.category} (-${d.diff})`).join(', ')}. `;
                }
                
                // Overall assessment
                const overallDiff = currentAssessment.score - compareAssessment.score;
                
                if (overallDiff > 10) {
                    analysisText += 'Overall, you show a remarkable improvement in your wisdom!';
                } else if (overallDiff > 5) {
                    analysisText += 'Overall, a positive development in your wisdom is noticeable.';
                } else if (overallDiff > 0) {
                    analysisText += 'Overall, you show a slight improvement in your wisdom.';
                } else if (overallDiff > -5) {
                    analysisText += 'Overall, your wisdom has slightly decreased. Reflect on possible reasons.';
                } else {
                    analysisText += 'Overall, there is a significant decrease in your wisdom. Take time for self-reflection.';
                }
            }
            
            analysisElement.textContent = analysisText;
        }
        
        // Custom tooltip handler for charts
        function externalTooltipHandler(context) {
            // Tooltip Element
            const {chart, tooltip} = context;
            const tooltipId = chart.canvas.id === 'trends-chart' ? 'trends-tooltip' : 'history-tooltip';
            const tooltipEl = document.getElementById(tooltipId);

            // Hide if no tooltip
            if (tooltip.opacity === 0) {
                tooltipEl.style.opacity = 0;
                return;
            }

            // Set Text
            if (tooltip.body) {
                const titleLines = tooltip.title || [];
                const bodyLines = tooltip.body.map(b => b.lines);
                
                const date = titleLines[0];
                const score = bodyLines[0][0].split(':')[1].trim();
                
                tooltipEl.innerHTML = `
                    <div class="chart-tooltip-date">${date}</div>
                    <div class="chart-tooltip-value">${score}</div>
                `;
                
                // Add details if it's the history chart
                if (tooltipId === 'history-tooltip' && appState.wisdomHistory.length > 0) {
                    const dataIndex = tooltip.dataPoints[0].dataIndex;
                    const sortedData = [...appState.wisdomHistory].sort((a, b) => new Date(a.date) - new Date(b.date));
                    
                    if (sortedData[dataIndex]) {
                        // Find top categories
                        const scores = sortedData[dataIndex].questionScores;
                        const categories = Object.keys(questionCategories).map((key, index) => ({
                            name: questionCategories[key].name,
                            score: scores[index]
                        }));
                        
                        const topCategory = [...categories].sort((a, b) => b.score - a.score)[0];
                        
                        tooltipEl.innerHTML += `
                            <div class="chart-tooltip-details">
                                Strongest Category: ${topCategory.name} (${topCategory.score}/5)
                            </div>
                        `;
                    }
                }
            }

            // Position tooltip
            const position = chart.canvas.getBoundingClientRect();
            tooltipEl.style.opacity = 1;
            tooltipEl.style.left = position.left + tooltip.caretX + 'px';
            tooltipEl.style.top = position.top + tooltip.caretY + 'px';
            tooltipEl.style.transform = 'translate(-50%, -100%)';
        }
        
        // Refresh charts
        function refreshCharts() {
            if (!appState.charts.trends) return;
            
            // Show loading animation
            document.getElementById('refresh-chart').innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="animate-spin">
                    <path d="M21 12a9 9 0 1 1-6.219-8.56"></path>
                </svg>
            `;
            
            // Update charts after a short delay
            setTimeout(() => {
                updateCharts();
                
                // Restore button
                document.getElementById('refresh-chart').innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
                        <path d="M21 3v5h-5"></path>
                        <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
                        <path d="M8 16H3v5"></path>
                    </svg>
                `;
                
                // Show notification
                showNotification('Charts Refreshed', 'Your wisdom charts have been updated with the latest data.', 'success');
            }, 800);
        }
        
        // Download chart
        function downloadChart() {
            const chartId = 'trends-chart';
            const chart = document.getElementById(chartId);
            
            if (!chart) return;
            
            // Create a temporary canvas to draw the chart with white background
            const tempCanvas = document.createElement('canvas');
            tempCanvas.width = chart.width;
            tempCanvas.height = chart.height;
            const tempCtx = tempCanvas.getContext('2d');
            
            // Draw white background
            tempCtx.fillStyle = 'white';
            tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
            
            // Draw the chart on top
            tempCtx.drawImage(chart, 0, 0);
            
            // Convert to image and download
            const link = document.createElement('a');
            link.download = 'wisdom-trends.png';
            link.href = tempCanvas.toDataURL('image/png');
            link.click();
            
            // Show notification
            showNotification('Chart Downloaded', 'Your wisdom trends chart has been downloaded as an image.', 'success');
        }
        
        // ===== HISTORY TABLE =====
        
        // Update history table
        function updateHistoryTable() {
            const tableBody = document.getElementById('history-table-body');
            const noHistoryMessage = document.getElementById('no-history-message');
            
            if (!appState.wisdomHistory || appState.wisdomHistory.length === 0) {
                tableBody.innerHTML = '';
                noHistoryMessage.style.display = 'block';
                return;
            }
            
            noHistoryMessage.style.display = 'none';
            
            // Sort history by date (newest first)
            const sortedHistory = [...appState.wisdomHistory].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Generate table rows
            tableBody.innerHTML = '';
            
            sortedHistory.forEach((entry, index) => {
                // Find strengths and improvements
                const strengths = [];
                const improvements = [];
                
                entry.questionScores.forEach((score, i) => {
                    const categoryId = Object.keys(questionCategories)[i];
                    const category = questionCategories[categoryId];
                    
                    if (score >= 4) {
                        strengths.push(category.name);
                    } else if (score <= 2) {
                        improvements.push(category.name);
                    }
                });
                
                // Create row
                const row = document.createElement('tr');
                row.className = index % 2 === 0 ? 'bg-card-hover' : '';
                
                row.innerHTML = `
                    <td class="p-2">
                        <div class="font-medium">${new Date(entry.date).toLocaleDateString()}</div>
                        <div class="text-xs text-muted">${new Date(entry.date).toLocaleTimeString()}</div>
                    </td>
                    <td class="p-2">
                        <div class="badge ${getBadgeClass(entry.score)}">${entry.score.toFixed(2)}%</div>
                    </td>
                    <td class="p-2">
                        <div class="text-sm">${strengths.length ? strengths.join(', ') : 'No specific strengths'}</div>
                    </td>
                    <td class="p-2">
                        <div class="text-sm">${improvements.length ? improvements.join(', ') : 'No specific areas for improvement'}</div>
                    </td>
                    <td class="p-2">
                        <button class="btn btn-icon btn-outline btn-sm view-entry" data-index="${index}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners to view buttons
            document.querySelectorAll('.view-entry').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.dataset.index);
                    viewHistoryEntry(sortedHistory[index]);
                });
            });
        }
        
        // Get badge class based on score
        function getBadgeClass(score) {
            if (score < 30) return 'badge-warning';
            if (score < 50) return 'badge-primary';
            if (score < 70) return 'badge-secondary';
            if (score < 90) return 'badge-accent';
            return 'badge-success';
        }
        
        // View history entry
        function viewHistoryEntry(entry) {
            // Set as current assessment
            appState.lastAssessment = entry;
            
            // Update results display
            updateResults(entry);
            
            // Show dashboard view with results section
            showDashboardView();
            showResultsSection();
        }
        
        // Filter history table
        function filterHistoryTable() {
            const searchTerm = document.getElementById('history-search').value.toLowerCase();
            const rows = document.querySelectorAll('#history-table-body tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }
        
        // ===== UI NAVIGATION =====
        
        // Show dashboard view
        function showDashboardView() {
            document.getElementById('dashboard-view').style.display = 'block';
            document.getElementById('history-view').style.display = 'none';
            document.getElementById('settings-view').style.display = 'none';
            
            document.getElementById('history-nav').classList.remove('active');
            document.getElementById('insights-nav').classList.remove('active');
            document.getElementById('settings-nav').classList.remove('active');
            document.querySelector('.nav-link[href="#"]').classList.add('active');
            
            appState.currentView = 'dashboard';
        }
        
        // Show history view
        function showHistoryView(e) {
            if (e) e.preventDefault();
            
            document.getElementById('dashboard-view').style.display = 'none';
            document.getElementById('history-view').style.display = 'block';
            document.getElementById('settings-view').style.display = 'none';
            
            document.querySelector('.nav-link[href="#"]').classList.remove('active');
            document.getElementById('insights-nav').classList.remove('active');
            document.getElementById('settings-nav').classList.remove('active');
            document.getElementById('history-nav').classList.add('active');
            
            appState.currentView = 'history';
            
            // Update history chart if it exists
            if (appState.charts.history) {
                appState.charts.history.update();
            }
        }
        
        // Show settings view
        function showSettingsView(e) {
            if (e) e.preventDefault();
            
            document.getElementById('dashboard-view').style.display = 'none';
            document.getElementById('history-view').style.display = 'none';
            document.getElementById('settings-view').style.display = 'block';
            
            document.querySelector('.nav-link[href="#"]').classList.remove('active');
            document.getElementById('history-nav').classList.remove('active');
            document.getElementById('insights-nav').classList.remove('active');
            document.getElementById('settings-nav').classList.add('active');
            
            appState.currentView = 'settings';
        }
        
        // Show results section
        function showResultsSection() {
            document.getElementById('assessment-section').classList.remove('md:col-span-2');
            document.getElementById('assessment-section').classList.add('md:col-span-1');
            document.getElementById('results-section').style.display = 'block';
        }
        
        // Show insights section
        function showInsightsSection(e) {
            if (e) e.preventDefault();
            
            // Make sure we're on the dashboard view
            showDashboardView();
            
            // Update navigation
            document.querySelector('.nav-link[href="#"]').classList.remove('active');
            document.getElementById('history-nav').classList.remove('active');
            document.getElementById('settings-nav').classList.remove('active');
            document.getElementById('insights-nav').classList.add('active');
            
            // Hide assessment section
            document.getElementById('assessment-section').style.display = 'none';
            
            // Show results if we have an assessment
            if (appState.lastAssessment) {
                document.getElementById('results-section').style.display = 'block';
                document.getElementById('results-section').classList.remove('md:col-span-1');
                document.getElementById('results-section').classList.add('md:col-span-3');
            }
            
            // Show insights section
            document.getElementById('insights-section').style.display = 'block';
            
            // Update progress steps
            document.getElementById('step-1').classList.remove('active');
            document.getElementById('step-2').classList.remove('active');
            document.getElementById('step-3').classList.add('active');
            
            // Update charts if they exist
            if (appState.charts.trends) {
                appState.charts.trends.update();
                appState.charts.categories.update();
                appState.charts.comparison.update();
            }
        }
        
        // Toggle mobile menu
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('active');
        }
        
        // Switch tab
        function switchTab(tabId) {
            // Remove active class from all tabs
            document.querySelectorAll('.tab-trigger').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Add active class to clicked tab
            document.querySelector(`.tab-trigger[data-tab="${tabId}"]`).classList.add('active');
            
            // Hide all tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(`tab-${tabId}`).classList.add('active');
            
            // Update state
            appState.currentTab = tabId;
            
            // Update charts if needed
            if (tabId === 'trends' && appState.charts.trends) {
                appState.charts.trends.update();
            } else if (tabId === 'categories' && appState.charts.categories) {
                appState.charts.categories.update();
            } else if (tabId === 'comparison' && appState.charts.comparison) {
                appState.charts.comparison.update();
            } else if (tabId === 'calendar') {
                const now = new Date();
                generateCalendar(now.getFullYear(), now.getMonth());
            }
        }
        
        // Switch period
        function switchPeriod(period) {
            // Remove active class from all period buttons
            document.querySelectorAll('.period-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to clicked button
            document.querySelector(`.period-btn[data-period="${period}"]`).classList.add('active');
            
            // Update state
            appState.currentPeriod = period;
            
            // Update trends chart
            updateTrendsChart();
        }
        
        // Switch compare
        function switchCompare(compare) {
            // Remove active class from all compare buttons
            document.querySelectorAll('.compare-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to clicked button
            document.querySelector(`.compare-btn[data-compare="${compare}"]`).classList.add('active');
            
            // Update state
            appState.currentCompare = compare;
            
            // Update comparison chart
            updateComparisonChart();
        }
        
        // Navigate to previous month in calendar
        function navigateToPreviousMonth() {
            const title = document.getElementById('calendar-title');
            const [month, year] = title.textContent.split(' ');
            
            const monthIndex = new Date(Date.parse(`${month} 1, ${year}`)).getMonth();
            const yearNum = parseInt(year);
            
            let newMonth = monthIndex - 1;
            let newYear = yearNum;
            
            if (newMonth < 0) {
                newMonth = 11;
                newYear--;
            }
            
            generateCalendar(newYear, newMonth);
        }
        
        // Navigate to next month in calendar
        function navigateToNextMonth() {
            const title = document.getElementById('calendar-title');
            const [month, year] = title.textContent.split(' ');
            
            const monthIndex = new Date(Date.parse(`${month} 1, ${year}`)).getMonth();
            const yearNum = parseInt(year);
            
            let newMonth = monthIndex + 1;
            let newYear = yearNum;
            
            if (newMonth > 11) {
                newMonth = 0;
                newYear++;
            }
            
            generateCalendar(newYear, newMonth);
        }
        
        // ===== MODALS =====
        
        // Show info modal
        function showInfoModal() {
            document.getElementById('info-modal').classList.add('active');
        }
        
        // Hide info modal
        function hideInfoModal() {
            document.getElementById('info-modal').classList.remove('active');
        }
        
        // Show details modal
        function showDetailsModal() {
            document.getElementById('details-modal').classList.add('active');
        }
        
        // Hide details modal
        function hideDetailsModal() {
            document.getElementById('details-modal').classList.remove('active');
        }
        
        // Show delete confirmation modal
        function showDeleteModal() {
            document.getElementById('delete-modal').classList.add('active');
        }
        
        // Hide delete confirmation modal
        function hideDeleteModal() {
            document.getElementById('delete-modal').classList.remove('active');
        }

























        
        // Show notification
        function showNotification(title, message, type = 'info') {
            const notificationContainer = document.getElementById('notification-container');
            
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `
                <div class="notification-icon">
                    ${getNotificationIcon(type)}
                </div>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
            `;
            
            // Add to container
            notificationContainer.appendChild(notification);
            
            // Trigger animation
            setTimeout(() => {
                notification.classList.add('active');
            }, 10);
            
            // Remove after timeout
            setTimeout(() => {
                notification.classList.remove('active');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }
        
        // Show share modal
        function showShareModal() {
            document.getElementById('share-modal').classList.add('active');
            
            // Generate a fake share link
            const shareLink = `https://wisewords01.com/produkt/wisewords/`;
            document.getElementById('share-link-input').value = shareLink;
        }
        
        // Hide share modal
        function hideShareModal() {
            document.getElementById('share-modal').classList.remove('active');
        }
        
        // Copy share link
        function copyShareLink() {
            const linkInput = document.getElementById('share-link-input');
            linkInput.select();
            document.execCommand('copy');
            
            // Change button text temporarily
            const copyButton = document.getElementById('copy-link-btn');
            const originalHTML = copyButton.innerHTML;
            copyButton.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                Copied!
            `;
            
            setTimeout(() => {
                copyButton.innerHTML = originalHTML;
            }, 2000);
            
            // Show notification
            showNotification('Link Copied', 'Share link has been copied to clipboard.', 'success');
        }
        
        // ===== SOCIAL SHARING =====
        
        // Share to Twitter
        function shareToTwitter() {
            const text = `I scored ${appState.lastAssessment?.score.toFixed(2)}% on my Wisdom Meter assessment! Check out this tool to measure your wisdom:`;
            const url = 'https://wisewords01.com/produkt/wisewords/';
            
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`, '_blank');
            
            // Hide modal
            hideShareModal();
            
            // Show notification
            showNotification('Shared to Twitter', 'Your wisdom score has been shared to Twitter.', 'success');
        }
        
        // Share to Facebook
        function shareToFacebook() {
            const url = 'https://wisewords01.com/produkt/wisewords/';
            
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`, '_blank');
            
            // Hide modal
            hideShareModal();
            
            // Show notification
            showNotification('Shared to Facebook', 'Your wisdom score has been shared to Facebook.', 'success');
        }
        
        // Share to LinkedIn
        function shareToLinkedIn() {
            const title = 'My Wisdom Meter Assessment';
            const summary = `I scored ${appState.lastAssessment?.score.toFixed(2)}% on my Wisdom Meter assessment! Check out this tool to measure your wisdom.`;
            const url = 'https://wisewords01.com/produkt/wisewords/';
            
            window.open(`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(url)}&title=${encodeURIComponent(title)}&summary=${encodeURIComponent(summary)}`, '_blank');
            
            // Hide modal
            hideShareModal();
            
            // Show notification
            showNotification('Shared to LinkedIn', 'Your wisdom score has been shared to LinkedIn.', 'success');
        }
        
        // Share to WhatsApp
        function shareToWhatsApp() {
            const text = `I scored ${appState.lastAssessment?.score.toFixed(2)}% on my Wisdom Meter assessment! Check out this tool to measure your wisdom: `;
            const url = 'https://wisewords01.com/produkt/wisewords/';
            
            window.open(`https://wa.me/?text=${encodeURIComponent(text + url)}`, '_blank');
            
            // Hide modal
            hideShareModal();
            
            // Show notification
            showNotification('Shared to WhatsApp', 'Your wisdom score has been shared to WhatsApp.', 'success');
        }
        
        // ===== OTHER FUNCTIONS =====
        
        // Export data
        function exportData() {
            if (!appState.wisdomHistory || appState.wisdomHistory.length === 0) {
                showNotification('No Data', 'There is no data to export.', 'warning');
                return;
            }
            
            // Show export options modal
            document.getElementById('export-json').click();
            
            // Show notification
            showNotification('Data Exported', 'Your wisdom data has been exported.', 'success');
        }
        
        // Export history
        function exportHistory() {
            if (!appState.wisdomHistory || appState.wisdomHistory.length === 0) {
                showNotification('No Data', 'There is no data to export.', 'warning');
                return;
            }
            
            exportToCSV(appState.wisdomHistory, 'wisdom-meter-history.csv');
            
            // Show notification
            showNotification('History Exported', 'Your wisdom history has been exported as CSV.', 'success');
        }
        
        // Print results
        function printResults() {
            window.print();
        }
        
        // Print details
        function printDetails() {
            // Close modal first
            hideDetailsModal();
            
            // Then print
            window.print();
        }
        
        // Clear history
        function clearHistory() {
            // Clear history data
            appState.wisdomHistory = [];
            appState.lastAssessment = null;
            
            // Clear localStorage
            localStorage.removeItem('wisdomHistory');
            
            // Update UI
            updateHistoryTable();
            
            // Reset charts
            if (appState.charts.trends) {
                appState.charts.trends.data.labels = [];
                appState.charts.trends.data.datasets[0].data = [];
                appState.charts.trends.update();
                
                appState.charts.history.data.labels = [];
                appState.charts.history.data.datasets[0].data = [];
                appState.charts.history.update();
            }
            
            // Hide results and insights sections
            document.getElementById('results-section').style.display = 'none';
            document.getElementById('insights-section').style.display = 'none';
            
            // Reset assessment section
            document.getElementById('assessment-section').classList.remove('md:col-span-1');
            document.getElementById('assessment-section').classList.add('md:col-span-2');
            document.getElementById('assessment-section').style.display = 'block';
            
            // Reset progress steps
            document.getElementById('step-1').classList.add('active');
            document.getElementById('step-1').classList.remove('completed');
            document.getElementById('step-2').classList.remove('active');
            document.getElementById('step-3').classList.remove('active');
            
            // Hide delete modal
            hideDeleteModal();
            
            // Show dashboard view
            showDashboardView();
            
            // Show notification
            showNotification('History Cleared', 'Your wisdom history has been cleared.', 'success');
        }
        
        // Generate new wisdom practice
        function newWisdomPractice() {
            document.getElementById('daily-wisdom-practice').textContent = getRandomItem(wisdomPractices);
            
            // Show notification
            showNotification('New Practice', 'A new daily wisdom practice has been generated.', 'info');
        }
        
        // Save practice
        function savePractice() {
            // In a real app, this would save to a database or localStorage
            showNotification('Practice Saved', 'Your daily wisdom practice has been saved.', 'success');
        }
        
        // Toggle dark mode
        function toggleDarkMode() {
            appState.darkMode = !appState.darkMode;
            
            if (appState.darkMode) {
                document.documentElement.classList.add('dark');
                updateThemeToggleIcon(true);
            } else {
                document.documentElement.classList.remove('dark');
                updateThemeToggleIcon(false);
            }
            
            // Save settings
            saveSettings();
            
            // Update charts if they exist
            if (appState.charts.trends) {
                appState.charts.trends.update();
                appState.charts.categories.update();
                appState.charts.comparison.update();
                appState.charts.history.update();
            }
        }
        
        // Update theme toggle icon
        function updateThemeToggleIcon(isDark) {
            const themeToggle = document.getElementById('theme-toggle');
            
            if (isDark) {
                themeToggle.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                `;
            } else {
                themeToggle.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
                    </svg>
                `;
            }
        }
        
        // Set theme
        function setTheme(theme) {
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
                appState.darkMode = true;
                updateThemeToggleIcon(true);
            } else if (theme === 'light') {
                document.documentElement.classList.remove('dark');
                appState.darkMode = false;
                updateThemeToggleIcon(false);
            } else {
                // Auto - use system preference
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                    appState.darkMode = true;
                    updateThemeToggleIcon(true);
                } else {
                    document.documentElement.classList.remove('dark');
                    appState.darkMode = false;
                    updateThemeToggleIcon(false);
                }
            }
            
            // Save settings
            saveSettings();
            
            // Show notification
            showNotification('Theme Updated', `Theme has been set to ${theme}.`, 'success');
        }
        
        // Set color scheme
        function setColorScheme(color) {
            appState.colorScheme = color;
            applyColorScheme(color);
            
            // Save settings
            saveSettings();
            
            // Show notification
            showNotification('Color Scheme Updated', `Color scheme has been set to ${color}.`, 'success');
        }
        
        // Apply color scheme
        function applyColorScheme(color) {
            const root = document.documentElement;
            
            switch (color) {
                case 'purple':
                    root.style.setProperty('--primary', '#8b5cf6');
                    root.style.setProperty('--primary-light', '#a78bfa');
                    root.style.setProperty('--primary-dark', '#7c3aed');
                    break;
                case 'green':
                    root.style.setProperty('--primary', '#10b981');
                    root.style.setProperty('--primary-light', '#34d399');
                    root.style.setProperty('--primary-dark', '#059669');
                    break;
                case 'amber':
                    root.style.setProperty('--primary', '#f59e0b');
                    root.style.setProperty('--primary-light', '#fbbf24');
                    root.style.setProperty('--primary-dark', '#d97706');
                    break;
                case 'blue':
                default:
                    root.style.setProperty('--primary', '#0ea5e9');
                    root.style.setProperty('--primary-light', '#38bdf8');
                    root.style.setProperty('--primary-dark', '#0284c7');
                    break;
            }
        }
        
        // Request notification permission
        function requestNotificationPermission() {
            if (!('Notification' in window)) {
                showNotification('Not Supported', 'Notifications are not supported in this browser.', 'warning');
                return;
            }
            
            Notification.requestPermission().then(permission => {
                if (permission === 'granted') {
                    appState.notifications.enabled = true;
                    saveSettings();
                    
                    // Show test notification
                    const notification = new Notification('Wisdom Meter Pro', {
                        body: 'Notifications are now enabled. You will receive reminders for your daily wisdom assessment.',
                        icon: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiMwZWE1ZTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMTIgMTdWM2E3IDcgMCAwIDAgMCAxNFoiPjwvcGF0aD48Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCI+PC9jaXJjbGU+PC9zdmc+'
                    });
                    
                    // Show in-app notification
                    showNotification('Notifications Enabled', 'You will now receive reminders for your daily wisdom assessment.', 'success');
                } else {
                    showNotification('Permission Denied', 'Notification permission was denied.', 'warning');
                }
            });
        }
        
        // Backup data
        function backupData() {
            if (!appState.wisdomHistory || appState.wisdomHistory.length === 0) {
                showNotification('No Data', 'There is no data to backup.', 'warning');
                return;
            }
            
            // Create backup object
            const backup = {
                wisdomHistory: appState.wisdomHistory,
                settings: {
                    darkMode: appState.darkMode,
                    colorScheme: appState.colorScheme,
                    notifications: appState.notifications
                },
                timestamp: new Date().toISOString(),
                version: '2.0.1'
            };
            
            // Export as JSON
            const jsonContent = JSON.stringify(backup, null, 2);
            const blob = new Blob([jsonContent], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `wisdom-meter-backup-${new Date().toISOString().slice(0, 10)}.json`);
            link.style.display = 'none';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Show notification
            showNotification('Backup Created', 'Your wisdom data has been backed up.', 'success');
        }
        
        // Restore data
        function restoreData() {
            // Create file input
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.json';
            fileInput.style.display = 'none';
            document.body.appendChild(fileInput);
            
            // Handle file selection
            fileInput.addEventListener('change', function() {
                if (!this.files || !this.files[0]) return;
                
                const file = this.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const backup = JSON.parse(e.target.result);
                        
                        // Validate backup
                        if (!backup.wisdomHistory || !Array.isArray(backup.wisdomHistory)) {
                            throw new Error('Invalid backup file');
                        }
                        
                        // Restore data
                        appState.wisdomHistory = backup.wisdomHistory;
                        
                        // Restore settings if available
                        if (backup.settings) {
                            if (backup.settings.darkMode !== undefined) {
                                appState.darkMode = backup.settings.darkMode;
                                if (appState.darkMode) {
                                    document.documentElement.classList.add('dark');
                                    updateThemeToggleIcon(true);
                                } else {
                                    document.documentElement.classList.remove('dark');
                                    updateThemeToggleIcon(false);
                                }
                            }
                            
                            if (backup.settings.colorScheme) {
                                appState.colorScheme = backup.settings.colorScheme;
                                applyColorScheme(backup.settings.colorScheme);
                            }
                            
                            if (backup.settings.notifications) {
                                appState.notifications = {
                                    ...appState.notifications,
                                    ...backup.settings.notifications
                                };
                            }
                        }
                        
                        // Save to localStorage
                        localStorage.setItem('wisdomHistory', JSON.stringify(appState.wisdomHistory));
                        saveSettings();
                        
                        // Set last assessment
                        if (appState.wisdomHistory.length > 0) {
                            appState.lastAssessment = [...appState.wisdomHistory]
                                .sort((a, b) => new Date(b.date) - new Date(a.date))[0];
                        }
                        
                        // Update UI
                        updateHistoryTable();
                        
                        // Update or initialize charts
                        if (appState.charts.trends) {
                            updateCharts();
                        } else if (appState.wisdomHistory.length > 0) {
                            initializeCharts();
                        }
                        
                        // Show notification
                        showNotification('Data Restored', `Successfully restored ${appState.wisdomHistory.length} wisdom assessments.`, 'success');
                        
                    } catch (error) {
                        console.error('Error restoring data:', error);
                        showNotification('Restore Failed', 'The backup file is invalid or corrupted.', 'error');
                    }
                };
                
                reader.readAsText(file);
                
                // Remove file input
                document.body.removeChild(fileInput);
            });
            
            // Trigger file selection
            fileInput.click();
        }
        
        // Confirm clear all data
        function confirmClearAllData() {
            if (confirm('Are you sure you want to clear all data? This action cannot be undone.')) {
                // Clear all data
                appState.wisdomHistory = [];
                appState.lastAssessment = null;
                
                // Clear localStorage
                localStorage.removeItem('wisdomHistory');
                
                // Update UI
                updateHistoryTable();
                
                // Reset charts
                if (appState.charts.trends) {
                    appState.charts.trends.data.labels = [];
                    appState.charts.trends.data.datasets[0].data = [];
                    appState.charts.trends.update();
                    
                    appState.charts.history.data.labels = [];
                    appState.charts.history.data.datasets[0].data = [];
                    appState.charts.history.update();
                }
                
                // Hide results and insights sections
                document.getElementById('results-section').style.display = 'none';
                document.getElementById('insights-section').style.display = 'none';
                
                // Reset assessment section
                document.getElementById('assessment-section').classList.remove('md:col-span-1');
                document.getElementById('assessment-section').classList.add('md:col-span-2');
                document.getElementById('assessment-section').style.display = 'block';
                
                // Reset progress steps
                document.getElementById('step-1').classList.add('active');
                document.getElementById('step-1').classList.remove('completed');
                document.getElementById('step-2').classList.remove('active');
                document.getElementById('step-3').classList.remove('active');
                
                // Show dashboard view
                showDashboardView();
                
                // Show notification
                showNotification('Data Cleared', 'All your wisdom data has been permanently deleted.', 'success');
            }
        }
        
        // Chart.js implementation (simplified version)
        class Chart {
            constructor(ctx, config) {
                this.ctx = ctx;
                this.canvas = ctx.canvas;
                this.config = config;
                this.data = config.data;
                this.options = config.options;
                this.tooltip = { opacity: 0, body: [], title: [], caretX: 0, caretY: 0 };
                
                this.init();
            }
            
            init() {
                // Set up canvas
                this.width = this.canvas.width;
                this.height = this.canvas.height;
                
                // Add event listeners for tooltips
                this.canvas.addEventListener('mousemove', this.handleMouseMove.bind(this));
                this.canvas.addEventListener('mouseout', this.handleMouseOut.bind(this));
                this.canvas.addEventListener('touchstart', this.handleTouchStart.bind(this), { passive: true });
                this.canvas.addEventListener('touchmove', this.handleTouchMove.bind(this), { passive: true });
                this.canvas.addEventListener('touchend', this.handleTouchEnd.bind(this), { passive: true });
                
                // Initial draw
                this.draw();
            }
            
            update() {
                this.draw();
            }
            
            draw() {
                const ctx = this.ctx;
                
                // Clear canvas
                ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Skip if no data
                if (!this.data.labels || !this.data.labels.length) return;
                
                // Draw based on chart type
                switch (this.config.type) {
                    case 'line':
                        this.drawLineChart();
                        break;
                    case 'bar':
                        this.drawBarChart();
                        break;
                    case 'radar':
                        this.drawRadarChart();
                        break;
                    default:
                        console.error('Unsupported chart type');
                }
            }
            
            drawLineChart() {
                const ctx = this.ctx;
                const data = this.data.datasets[0].data;
                
                // Skip if no data
                if (!data || !data.length) return;
                
                // Calculate scales
                const yScale = this.calculateYScale();
                const xScale = this.calculateXScale();
                
                // Draw grid lines
                this.drawGrid(xScale, yScale);
                
                // Draw axes labels
                this.drawAxesLabels(xScale, yScale);
                
                // Draw line
                this.drawLine(xScale, yScale);
                
                // Draw points
                this.drawPoints(xScale, yScale);
            }
            
            drawBarChart() {
                const ctx = this.ctx;
                
                // Skip if no data
                if (!this.data.datasets || !this.data.datasets.length) return;
                
                // Calculate scales
                const yScale = this.calculateYScale();
                const xScale = this.calculateXScale();
                
                // Draw grid lines
                this.drawGrid(xScale, yScale);
                
                // Draw axes labels
                this.drawAxesLabels(xScale, yScale);
                
                // Draw bars
                this.drawBars(xScale, yScale);
                
                // Draw legend
                this.drawLegend();
            }
            
            drawRadarChart() {
                const ctx = this.ctx;
                const data = this.data.datasets[0].data;
                
                // Skip if no data
                if (!data || !data.length) return;
                
                // Calculate center and radius
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                const radius = Math.min(centerX, centerY) * 0.8;
                
                // Draw radar grid
                this.drawRadarGrid(centerX, centerY, radius);
                
                // Draw radar data
                this.drawRadarData(centerX, centerY, radius);
                
                // Draw radar points
                this.drawRadarPoints(centerX, centerY, radius);
            }
            
            calculateYScale() {
                let min = Infinity;
                let max = -Infinity;
                
                // Find min and max values across all datasets
                this.data.datasets.forEach(dataset => {
                    const dataMin = Math.min(...dataset.data);
                    const dataMax = Math.max(...dataset.data);
                    
                    if (dataMin < min) min = dataMin;
                    if (dataMax > max) max = dataMax;
                });
                
                // Apply options
                if (this.options.scales && this.options.scales.y) {
                    if (this.options.scales.y.beginAtZero) min = 0;
                    if (this.options.scales.y.max !== undefined) max = this.options.scales.y.max;
                    if (this.options.scales.y.min !== undefined) min = this.options.scales.y.min;
                }
                
                return {
                    min,
                    max,
                    getPixelForValue: (value) => {
                        const range = max - min;
                        const percentage = (value - min) / range;
                        return this.height - (percentage * this.height * 0.8 + this.height * 0.1);
                    }
                };
            }
            
            calculateXScale() {
                const labels = this.data.labels;
                const count = labels.length;
                
                return {
                    labels,
                    getPixelForValue: (index) => {
                        return (index / (count - 1)) * this.width * 0.8 + this.width * 0.1;
                    }
                };
            }
            
            drawGrid(xScale, yScale) {
                const ctx = this.ctx;
                const gridColor = this.options.scales.y.grid.color;
                
                ctx.beginPath();
                ctx.strokeStyle = gridColor;
                ctx.lineWidth = 1;
                
                // Horizontal grid lines
                for (let i = 0; i <= 5; i++) {
                    const value = yScale.min + (yScale.max - yScale.min) * (i / 5);
                    const y = yScale.getPixelForValue(value);
                    
                    ctx.moveTo(this.width * 0.1, y);
                    ctx.lineTo(this.width * 0.9, y);
                }
                
                ctx.stroke();
            }
            
            drawAxesLabels(xScale, yScale) {
                const ctx = this.ctx;
                const labels = xScale.labels;
                
                // X-axis labels
                ctx.textAlign = 'center';
                ctx.textBaseline = 'top';
                ctx.fillStyle = this.options.scales.x.ticks.color;
                ctx.font = '10px Arial';
                
                labels.forEach((label, i) => {
                    const x = xScale.getPixelForValue(i);
                    ctx.save();
                    ctx.translate(x, this.height * 0.9 + 5);
                    ctx.rotate(Math.PI / 4);
                    ctx.fillText(label, 0, 0);
                    ctx.restore();
                });
                
                // Y-axis labels
                ctx.textAlign = 'right';
                ctx.textBaseline = 'middle';
                ctx.fillStyle = this.options.scales.y.ticks.color;
                
                for (let i = 0; i <= 5; i++) {
                    const value = yScale.min + (yScale.max - yScale.min) * (i / 5);
                    const y = yScale.getPixelForValue(value);
                    
                    let label = value.toString();
                    if (this.options.scales.y.ticks.callback) {
                        label = this.options.scales.y.ticks.callback(value);
                    }
                    
                    ctx.fillText(label, this.width * 0.09, y);
                }
            }
            
            drawLine(xScale, yScale) {
                const ctx = this.ctx;
                const dataset = this.data.datasets[0];
                const data = dataset.data;
                
                if (!data.length) return;
                
                // Draw line
                ctx.beginPath();
                ctx.strokeStyle = dataset.borderColor;
                ctx.lineWidth = dataset.borderWidth;
                ctx.lineJoin = 'round';
                
                data.forEach((value, i) => {
                    const x = xScale.getPixelForValue(i);
                    const y = yScale.getPixelForValue(value);
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                
                ctx.stroke();
                
                // Fill area
                if (dataset.fill) {
                    ctx.lineTo(xScale.getPixelForValue(data.length - 1), yScale.getPixelForValue(yScale.min));
                    ctx.lineTo(xScale.getPixelForValue(0), yScale.getPixelForValue(yScale.min));
                    ctx.closePath();
                    ctx.fillStyle = dataset.backgroundColor;
                    ctx.fill();
                }
            }
            
            drawPoints(xScale, yScale) {
                const ctx = this.ctx;
                const dataset = this.data.datasets[0];
                const data = dataset.data;
                
                data.forEach((value, i) => {
                    const x = xScale.getPixelForValue(i);
                    const y = yScale.getPixelForValue(value);
                    
                    ctx.beginPath();
                    ctx.arc(x, y, dataset.pointRadius, 0, Math.PI * 2);
                    ctx.fillStyle = dataset.pointBackgroundColor;
                    ctx.strokeStyle = dataset.pointBorderColor;
                    ctx.lineWidth = 2;
                    ctx.fill();
                    ctx.stroke();
                });
            }
            
            drawBars(xScale, yScale) {
                const ctx = this.ctx;
                const datasets = this.data.datasets;
                const labels = this.data.labels;
                
                const barCount = datasets.length;
                const barWidth = (this.width * 0.8 / labels.length) / (barCount + 0.5);
                
                datasets.forEach((dataset, datasetIndex) => {
                    const data = dataset.data;
                    
                    data.forEach((value, index) => {
                        const x = xScale.getPixelForValue(index) - (barWidth * barCount / 2) + (datasetIndex * barWidth) + (barWidth / 2);
                        const y = yScale.getPixelForValue(value);
                        const height = yScale.getPixelForValue(0) - y;
                        
                        ctx.beginPath();
                        ctx.fillStyle = dataset.backgroundColor;
                        ctx.strokeStyle = dataset.borderColor;
                        ctx.lineWidth = dataset.borderWidth;
                        
                        // Draw rounded rectangle
                        const radius = dataset.borderRadius || 0;
                        this.roundRect(ctx, x, y, barWidth, height, radius);
                        
                        ctx.fill();
                        ctx.stroke();
                    });
                });
            }
            
            roundRect(ctx, x, y, width, height, radius) {
                if (radius === 0) {
                    ctx.rect(x, y, width, height);
                    return;
                }
                
                ctx.moveTo(x + radius, y);
                ctx.lineTo(x + width - radius, y);
                ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
                ctx.lineTo(x + width, y + height);
                ctx.lineTo(x, y + height);
                ctx.lineTo(x, y + radius);
                ctx.quadraticCurveTo(x, y, x + radius, y);
                ctx.closePath();
            }
            
            drawLegend() {
                const ctx = this.ctx;
                const datasets = this.data.datasets;
                
                if (!datasets.length || !this.options.plugins.legend.display) return;
                
                const legendItems = datasets.map(dataset => ({
                    label: dataset.label,
                    color: dataset.backgroundColor
                }));
                
                const itemHeight = 20;
                const itemWidth = 80;
                const padding = 10;
                
                // Draw legend background
                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                ctx.fillRect(
                    this.width - itemWidth - padding * 2,
                    padding,
                    itemWidth + padding * 2,
                    (itemHeight + padding) * legendItems.length
                );
                
                // Draw legend items
                legendItems.forEach((item, index) => {
                    const y = padding + index * (itemHeight + 5) + itemHeight / 2;
                    
                    // Draw color box
                    ctx.fillStyle = item.color;
                    ctx.fillRect(this.width - itemWidth - padding + 5, y - 8, 16, 16);
                    
                    // Draw label
                    ctx.fillStyle = this.options.plugins.legend.labels.color;
                    ctx.textAlign = 'left';
                    ctx.textBaseline = 'middle';
                    ctx.font = '12px Arial';
                    ctx.fillText(item.label, this.width - itemWidth - padding + 30, y);
                });
            }
            
            drawRadarGrid(centerX, centerY, radius) {
                const ctx = this.ctx;
                const labels = this.data.labels;
                const angleStep = (Math.PI * 2) / labels.length;
                
                // Draw circular grid lines
                ctx.strokeStyle = this.options.scales.r.grid.color;
                ctx.lineWidth = 1;
                
                for (let i = 1; i <= 5; i++) {
                    const r = radius * (i / 5);
                    
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, r, 0, Math.PI * 2);
                    ctx.stroke();
                }
                
                // Draw radial grid lines
                labels.forEach((label, i) => {
                    const angle = i * angleStep - Math.PI / 2;
                    const x = centerX + Math.cos(angle) * radius;
                    const y = centerY + Math.sin(angle) * radius;
                    
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.lineTo(x, y);
                    ctx.stroke();
                    
                    // Draw labels
                    const labelX = centerX + Math.cos(angle) * (radius + 15);
                    const labelY = centerY + Math.sin(angle) * (radius + 15);
                    
                    ctx.fillStyle = this.options.scales.r.pointLabels.color;
                    ctx.font = `${this.options.scales.r.pointLabels.font.size}px Arial`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(label, labelX, labelY);
                });
            }
            
            drawRadarData(centerX, centerY, radius) {
                const ctx = this.ctx;
                const dataset = this.data.datasets[0];
                const data = dataset.data;
                const labels = this.data.labels;
                const angleStep = (Math.PI * 2) / labels.length;
                
                // Draw radar area
                ctx.beginPath();
                
                data.forEach((value, i) => {
                    const angle = i * angleStep - Math.PI / 2;
                    const normalizedValue = value / this.options.scales.r.suggestedMax;
                    const x = centerX + Math.cos(angle) * radius * normalizedValue;
                    const y = centerY + Math.sin(angle) * radius * normalizedValue;
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                
                ctx.closePath();
                ctx.fillStyle = dataset.backgroundColor;
                ctx.fill();
                
                ctx.strokeStyle = dataset.borderColor;
                ctx.lineWidth = dataset.borderWidth;
                ctx.stroke();
            }
            
            drawRadarPoints(centerX, centerY, radius) {
                const ctx = this.ctx;
                const dataset = this.data.datasets[0];
                const data = dataset.data;
                const labels = this.data.labels;
                const angleStep = (Math.PI * 2) / labels.length;
                
                data.forEach((value, i) => {
                    const angle = i * angleStep - Math.PI / 2;
                    const normalizedValue = value / this.options.scales.r.suggestedMax;
                    const x = centerX + Math.cos(angle) * radius * normalizedValue;
                    const y = centerY + Math.sin(angle) * radius * normalizedValue;
                    
                    ctx.beginPath();
                    ctx.arc(x, y, dataset.pointRadius, 0, Math.PI * 2);
                    ctx.fillStyle = dataset.pointBackgroundColor;
                    ctx.strokeStyle = dataset.pointBorderColor;
                    ctx.lineWidth = 2;
                    ctx.fill();
                    ctx.stroke();
                });
            }
            
            handleMouseMove(event) {
                const rect = this.canvas.getBoundingClientRect();
                const x = event.clientX - rect.left;
                const y = event.clientY - rect.top;
                
                // Handle based on chart type
                switch (this.config.type) {
                    case 'line':
                        this.handleLineChartHover(x, y);
                        break;
                    case 'bar':
                        this.handleBarChartHover(x, y);
                        break;
                    case 'radar':
                        this.handleRadarChartHover(x, y);
                        break;
                }
            }
            
            handleTouchStart(event) {
                if (event.touches.length > 0) {
                    const touch = event.touches[0];
                    const rect = this.canvas.getBoundingClientRect();
                    const x = touch.clientX - rect.left;
                    const y = touch.clientY - rect.top;
                    
                    // Handle based on chart type
                    switch (this.config.type) {
                        case 'line':
                            this.handleLineChartHover(x, y);
                            break;
                        case 'bar':
                            this.handleBarChartHover(x, y);
                            break;
                        case 'radar':
                            this.handleRadarChartHover(x, y);
                            break;
                    }
                }
            }
            
            handleTouchMove(event) {
                if (event.touches.length > 0) {
                    const touch = event.touches[0];
                    const rect = this.canvas.getBoundingClientRect();
                    const x = touch.clientX - rect.left;
                    const y = touch.clientY - rect.top;
                    
                    // Handle based on chart type
                    switch (this.config.type) {
                        case 'line':
                            this.handleLineChartHover(x, y);
                            break;
                        case 'bar':
                            this.handleBarChartHover(x, y);
                            break;
                        case 'radar':
                            this.handleRadarChartHover(x, y);
                            break;
                    }
                }
            }
            
            handleTouchEnd() {
                // Hide tooltip after a delay
                setTimeout(() => {
                    this.tooltip.opacity = 0;
                    
                    if (this.options.plugins.tooltip.external) {
                        this.options.plugins.tooltip.external({ chart: this, tooltip: this.tooltip });
                    }
                    
                    this.draw();
                }, 2000);
            }
            
            handleLineChartHover(x, y) {
                const xScale = this.calculateXScale();
                const yScale = this.calculateYScale();
                const data = this.data.datasets[0].data;
                
                // Find closest point
                let minDistance = Infinity;
                let closestIndex = -1;
                
                data.forEach((value, i) => {
                    const pointX = xScale.getPixelForValue(i);
                    const pointY = yScale.getPixelForValue(value);
                    
                    const distance = Math.sqrt(Math.pow(x - pointX, 2) + Math.pow(y - pointY, 2));
                    
                    if (distance < minDistance) {
                        minDistance = distance;
                        closestIndex = i;
                    }
                });
                
                // Show tooltip if point is close enough
                if (minDistance < 30 && closestIndex !== -1) {
                    const pointX = xScale.getPixelForValue(closestIndex);
                    const pointY = yScale.getPixelForValue(data[closestIndex]);
                    
                    this.tooltip = {
                        opacity: 1,
                        title: [this.data.labels[closestIndex]],
                        body: [{ lines: [`${this.data.datasets[0].label}: ${data[closestIndex].toFixed(2)}%`] }],
                        caretX: pointX,
                        caretY: pointY,
                        dataPoints: [{ dataIndex: closestIndex }]
                    };
                    
                    if (this.options.plugins.tooltip.external) {
                        this.options.plugins.tooltip.external({ chart: this, tooltip: this.tooltip });
                    }
                    
                    // Highlight point
                    this.draw();
                    const ctx = this.ctx;
                    ctx.beginPath();
                    ctx.arc(pointX, pointY, this.data.datasets[0].pointHoverRadius, 0, Math.PI * 2);
                    ctx.fillStyle = this.data.datasets[0].pointHoverBackgroundColor;
                    ctx.strokeStyle = this.data.datasets[0].pointHoverBorderColor;
                    ctx.lineWidth = 2;
                    ctx.fill();
                    ctx.stroke();
                }
            }
            
            handleBarChartHover(x, y) {
                // Similar to line chart hover, but for bar charts
                // Implementation omitted for brevity
            }
            
            handleRadarChartHover(x, y) {
                // Similar to line chart hover, but for radar charts
                // Implementation omitted for brevity
            }
            
            handleMouseOut() {
                this.tooltip.opacity = 0;
                
                if (this.options.plugins.tooltip.external) {
                    this.options.plugins.tooltip.external({ chart: this, tooltip: this.tooltip });
                }
                
                this.draw();
            }
        }
    </script>
</body>
</html>
